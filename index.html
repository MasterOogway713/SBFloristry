<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- 1. SEO META TAGS -->
    <meta name="description" content="SB Floristry is a premier mother and daughter florist team serving Essex and London. Specializing in luxury seasonal bouquets, weddings, and bespoke floral installations.">
    <meta name="keywords" content="Florist Essex, Luxury Flowers London, Wedding Florist, Mother Daughter Florist, Bespoke Floral Design">
    <meta name="author" content="SB Floristry">
    <meta property="og:title" content="SB Floristry | Essex & London's Premier Florists">
    <meta property="og:description" content="Artistry in every bloom. Hand-tied in Essex, delivered to London.">
    <meta property="og:image" content="images/hero.jpg">
    
    <title>SB Floristry | Essex & London's Premier Mother-Daughter Florists</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Playfair+Display:ital,wght@0,300;0,400;0,500;1,400&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'sb-black': '#0a0a0a', 
                        'sb-gold': '#D4AF37', /* Slightly more muted gold for luxury */
                        'sb-cream': '#F9F8F6', 
                        'sb-dark': '#1A1A1A',
                    },
                    fontFamily: {
                        serif: ['"Playfair Display"', 'serif'],
                        sans: ['"Lato"', 'sans-serif'],
                    },
                    letterSpacing: {
                        'luxury': '0.25em', 
                        'super-wide': '0.35em',
                    },
                    animation: {
                        'fade-in-up': 'fadeInUp 1.2s ease-out forwards',
                        'fade-in': 'fadeIn 1s ease-out forwards',
                    },
                    keyframes: {
                        fadeInUp: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Custom Utilities */
        .text-shadow {
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .hero-zoom {
            animation: slowZoom 25s infinite alternate;
        }
        @keyframes slowZoom {
            from { transform: scale(1); }
            to { transform: scale(1.05); }
        }

        .text-gold-metallic {
            background: linear-gradient(to right, #bf953f, #fcf6ba, #b38728, #fbf5b7, #aa771c);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .bg-gold-shimmer {
            background: linear-gradient(
                90deg, 
                #997b3a 0%,   
                #b89546 25%,  
                #D4AF37 50%,  
                #b89546 75%,  
                #997b3a 100%  
            );
            background-size: 200% auto;
            animation: subtleShimmer 8s linear infinite;
        }
        
        @keyframes subtleShimmer {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Staggered Reveal Animation for SECTIONS */
        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: all 1s ease-out;
        }
        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }

        /* IMAGE FADE IN LOGIC */
        img {
            opacity: 0; 
            transition: opacity 1.2s ease-out; 
        }
        img.loaded {
            opacity: 1;
        }

        /* CUSTOM TEXT SELECTION COLOR */
        ::selection {
            background: #D4AF37; 
            color: #0a0a0a; 
        }

        /* Luxury Button Hover Effect (Thinner lines) */
        .btn-luxury {
            position: relative;
            overflow: hidden;
            transition: color 0.4s;
            z-index: 1;
        }
        .btn-luxury::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #D4AF37; 
            z-index: -1;
            transform: scaleY(0);
            transform-origin: bottom;
            transition: transform 0.4s cubic-bezier(0.19, 1, 0.22, 1);
        }
        .btn-luxury:hover::before {
            transform: scaleY(1);
        }
        .btn-luxury:hover {
            color: #0a0a0a !important; 
            border-color: #D4AF37;
        }

        /* Side Cart Styles */
        .cart-overlay {
            background-color: rgba(0,0,0,0.3);
            backdrop-filter: blur(4px);
        }
        .cart-scroll::-webkit-scrollbar {
            width: 4px;
        }
        .cart-scroll::-webkit-scrollbar-track {
            background: #F9F8F6; 
        }
        .cart-scroll::-webkit-scrollbar-thumb {
            background: #D4AF37; 
            border-radius: 2px;
        }

        /* SPA VIEW LOGIC */
        .view-section {
            display: none;
            opacity: 0;
            transition: opacity 0.8s ease-in-out;
        }
        .view-section.active-view {
            display: block;
            opacity: 1;
            animation: fadeIn 1.2s ease-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Dropdown Styles */
        .nav-dropdown {
            opacity: 0;
            visibility: hidden;
            transform: translateY(10px);
            transition: all 0.3s ease-in-out;
        }
        .group:hover .nav-dropdown {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* Mobile Accordion */
        .mobile-accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .mobile-accordion-btn.active + .mobile-accordion-content {
            max-height: 500px;
        }
        .mobile-accordion-btn.active i {
            transform: rotate(180deg);
        }
    </style>
</head>
<body class="font-sans text-sb-dark antialiased bg-sb-cream flex flex-col min-h-screen">

    <!-- Announcement Bar (Slimmer) -->
    <div class="bg-gold-shimmer text-sb-black text-[10px] py-2.5 px-4 text-center tracking-[0.25em] uppercase font-bold border-b border-sb-cream/20">
        <p>Family Run • Free Local Delivery (5 Miles) • UK Standard £4.99</p>
    </div>

    <!-- Header / Navigation (Refined) -->
    <header class="sticky top-0 z-50 bg-sb-black/95 backdrop-blur-md transition-all duration-300 border-b border-white/5" id="main-header">
        <div class="container mx-auto px-6 lg:px-12">
            <!-- Grid Layout - Perfectly Balanced -->
            <div class="grid grid-cols-[1fr_auto_1fr] items-center h-20 md:h-24">
                
                <!-- Left Nav -->
                <div class="flex items-center justify-start lg:justify-end h-full">
                    <button id="mobile-menu-btn" class="lg:hidden text-xl text-sb-cream focus:outline-none hover:text-sb-gold transition-colors mr-auto p-2">
                        <i class="fas fa-bars"></i>
                    </button>
                    <!-- Refined Typography: Smaller, Lighter, Wider Spacing -->
                    <nav class="hidden lg:flex space-x-8 xl:space-x-10 text-[11px] font-medium tracking-luxury text-gray-300 uppercase items-center">
                        <a href="#home" class="hover:text-sb-gold transition-colors duration-300">Home</a>
                        
                        <!-- Collections Dropdown -->
                        <div class="relative group h-full flex items-center">
                            <button class="hover:text-sb-gold transition-colors duration-300 focus:outline-none py-4 uppercase tracking-luxury flex items-center gap-1">
                                Collections <i class="fas fa-chevron-down text-[8px] opacity-50 ml-1"></i>
                            </button>
                            <div class="nav-dropdown absolute top-full left-0 w-48 bg-sb-black border border-white/10 shadow-2xl pt-2 pb-2">
                                <a href="#seasonal" class="block px-6 py-3 hover:bg-white/5 hover:text-sb-gold text-[10px] tracking-luxury transition-colors">Seasonal</a>
                                <a href="#luxury" class="block px-6 py-3 hover:bg-white/5 hover:text-sb-gold text-[10px] tracking-luxury transition-colors">Luxury</a>
                            </div>
                        </div>
                    </nav>
                </div>

                <!-- Center Logo -->
                <div class="flex justify-center h-full items-center px-8">
                    <a href="#home" class="group block text-center">
                        <img src="images/logo.png" alt="SB Floristry" class="h-16 w-auto object-contain opacity-90 group-hover:opacity-100 transition-opacity">
                    </a>
                </div>

                <!-- Right Nav -->
                <div class="flex items-center justify-end lg:justify-between h-full w-full">
                    <nav class="hidden lg:flex space-x-8 xl:space-x-10 text-[11px] font-medium tracking-luxury text-gray-300 uppercase items-center">
                        
                        <!-- Themed Dropdown -->
                        <div class="relative group h-full flex items-center">
                            <button class="hover:text-sb-gold transition-colors duration-300 focus:outline-none py-4 uppercase tracking-luxury flex items-center gap-1">
                                Themed <i class="fas fa-chevron-down text-[8px] opacity-50 ml-1"></i>
                            </button>
                            <div class="nav-dropdown absolute top-full left-0 w-48 bg-sb-black border border-white/10 shadow-2xl pt-2 pb-2">
                                <a href="#fairytale" class="block px-6 py-3 hover:bg-white/5 hover:text-sb-gold text-[10px] tracking-luxury transition-colors">Fairy Tale</a>
                                <a href="#gothic" class="block px-6 py-3 hover:bg-white/5 hover:text-sb-gold text-[10px] tracking-luxury transition-colors">Gothic</a>
                            </div>
                        </div>

                        <!-- Events Dropdown -->
                        <div class="relative group h-full flex items-center">
                            <button class="hover:text-sb-gold transition-colors duration-300 focus:outline-none py-4 uppercase tracking-luxury flex items-center gap-1">
                                Events <i class="fas fa-chevron-down text-[8px] opacity-50 ml-1"></i>
                            </button>
                            <div class="nav-dropdown absolute top-full right-0 w-56 bg-sb-black border border-white/10 shadow-2xl pt-2 pb-2">
                                <a href="#weddings" class="block px-6 py-3 hover:bg-white/5 hover:text-sb-gold text-[10px] tracking-luxury transition-colors">Weddings</a>
                                <a href="#funerals" class="block px-6 py-3 hover:bg-white/5 hover:text-sb-gold text-[10px] tracking-luxury transition-colors">Funerals</a>
                                <a href="#babyshowers" class="block px-6 py-3 hover:bg-white/5 hover:text-sb-gold text-[10px] tracking-luxury transition-colors">Baby Showers</a>
                                <a href="#genderreveal" class="block px-6 py-3 hover:bg-white/5 hover:text-sb-gold text-[10px] tracking-luxury transition-colors">Gender Reveal</a>
                                <a href="#workevents" class="block px-6 py-3 hover:bg-white/5 hover:text-sb-gold text-[10px] tracking-luxury transition-colors">Work Events</a>
                            </div>
                        </div>
                    </nav>

                    <!-- Icons (Smaller, more elegant) -->
                    <div class="flex items-center space-x-6 text-sb-cream/80">
                        <button class="hidden lg:block hover:text-sb-gold transition-colors"><i class="fas fa-search text-sm"></i></button>
                        <button id="cart-icon-btn" class="relative hover:text-sb-gold transition-colors group p-1">
                            <i class="fas fa-shopping-bag text-sm"></i>
                            <span id="cart-count" class="absolute -top-2 -right-2 text-sb-gold font-serif text-[10px] w-4 h-4 flex items-center justify-center opacity-0 transition-opacity duration-300">0</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Mobile Menu (Accordion Style) -->
    <div id="mobile-menu" class="fixed inset-0 bg-sb-black z-[100] transform -translate-x-full transition-transform duration-500 ease-in-out lg:hidden flex flex-col pt-20 px-8 overflow-y-auto">
        <button id="close-menu-btn" class="absolute top-6 right-6 text-2xl text-sb-cream hover:text-sb-gold transition-colors p-2">
            <i class="fas fa-times"></i>
        </button>
        <nav class="flex flex-col space-y-4 text-lg font-serif text-sb-cream text-center mt-6 font-light">
            <a href="#home" class="border-b border-white/5 pb-3 hover:text-sb-gold transition-colors block">Home</a>
            
            <!-- Collections Accordion -->
            <div>
                <button class="mobile-accordion-btn w-full flex justify-between items-center text-sb-gold text-sm tracking-widest uppercase py-3 border-b border-white/5 focus:outline-none">
                    Collections <i class="fas fa-chevron-down text-xs transition-transform duration-300"></i>
                </button>
                <div class="mobile-accordion-content bg-white/5">
                    <a href="#seasonal" class="block py-3 text-base text-gray-300 hover:text-white">Seasonal</a>
                    <a href="#luxury" class="block py-3 text-base text-gray-300 hover:text-white">Luxury</a>
                </div>
            </div>

            <!-- Themed Accordion -->
            <div>
                <button class="mobile-accordion-btn w-full flex justify-between items-center text-sb-gold text-sm tracking-widest uppercase py-3 border-b border-white/5 focus:outline-none">
                    Themed <i class="fas fa-chevron-down text-xs transition-transform duration-300"></i>
                </button>
                <div class="mobile-accordion-content bg-white/5">
                    <a href="#fairytale" class="block py-3 text-base text-gray-300 hover:text-white">Fairy Tale</a>
                    <a href="#gothic" class="block py-3 text-base text-gray-300 hover:text-white">Gothic</a>
                </div>
            </div>

            <!-- Events Accordion -->
            <div>
                <button class="mobile-accordion-btn w-full flex justify-between items-center text-sb-gold text-sm tracking-widest uppercase py-3 border-b border-white/5 focus:outline-none">
                    Events <i class="fas fa-chevron-down text-xs transition-transform duration-300"></i>
                </button>
                <div class="mobile-accordion-content bg-white/5">
                    <a href="#weddings" class="block py-3 text-base text-gray-300 hover:text-white">Weddings</a>
                    <a href="#funerals" class="block py-3 text-base text-gray-300 hover:text-white">Funerals</a>
                    <a href="#babyshowers" class="block py-3 text-base text-gray-300 hover:text-white">Baby Showers</a>
                    <a href="#genderreveal" class="block py-3 text-base text-gray-300 hover:text-white">Gender Reveal</a>
                    <a href="#workevents" class="block py-3 text-base text-gray-300 hover:text-white">Work Events</a>
                </div>
            </div>
        </nav>
    </div>

    <!-- SIDE CART -->
    <div id="side-cart-overlay" class="fixed inset-0 cart-overlay z-[150] hidden opacity-0 transition-opacity duration-300"></div>
    <div id="side-cart" class="fixed top-0 right-0 h-full w-full max-w-[400px] bg-white z-[160] transform translate-x-full transition-transform duration-500 shadow-2xl flex flex-col">
        <div class="shrink-0 p-6 border-b border-gray-100 flex justify-between items-center bg-sb-black text-sb-cream">
            <h2 class="font-serif text-2xl tracking-wide font-light">Your Selection</h2>
            <button id="close-cart-btn" class="text-sb-gold hover:text-white transition-colors text-2xl">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <!-- Fulfillment Toggle -->
        <div class="shrink-0 px-6 py-4 bg-gray-50 border-b border-gray-100">
            <div class="flex rounded border border-gray-300 overflow-hidden mb-3">
                <button id="delivery-tab" class="flex-1 py-2 text-xs uppercase font-bold tracking-luxury bg-sb-black text-white transition-colors">Delivery</button>
                <button id="collection-tab" class="flex-1 py-2 text-xs uppercase font-bold tracking-luxury bg-white text-gray-500 hover:bg-gray-100 transition-colors">Collection</button>
            </div>
            
            <div id="shipping-info">
                 <p id="shipping-message" class="text-xs font-bold text-center text-sb-black mb-2">
                     Spend <span class="text-sb-gold">£60.00</span> more for Free Delivery
                 </p>
                 <div class="w-full bg-gray-200 h-1.5 rounded-full overflow-hidden">
                     <div id="shipping-bar" class="bg-sb-gold h-full rounded-full transition-all duration-500" style="width: 0%"></div>
                 </div>
            </div>
            <div id="collection-info" class="hidden text-center">
                <p class="text-xs font-bold text-sb-black uppercase tracking-luxury"><i class="fas fa-map-marker-alt text-sb-gold mr-1"></i> Pickup from Essex Studio</p>
            </div>
        </div>

        <div class="flex-1 overflow-y-auto cart-scroll bg-white">
            <div id="cart-items-container" class="p-6 pb-2">
                <div class="flex flex-col items-center justify-center h-32 text-gray-400 space-y-4">
                    <p class="text-sm tracking-luxury uppercase">Your cart is empty</p>
                </div>
            </div>
            <div id="cart-extras" class="px-6 py-6 bg-sb-cream border-t border-gray-100 hidden">
                <div class="mb-6">
                    <label for="cart-note" class="block text-xs font-bold tracking-luxury uppercase text-gray-400 mb-2">Gift Message</label>
                    <textarea id="cart-note" rows="2" class="w-full bg-white border border-gray-200 p-3 text-base text-sb-black placeholder-gray-300 focus:border-sb-gold outline-none resize-none" placeholder="Write a note..."></textarea>
                </div>
                <div class="mb-0">
                    <label for="delivery-date" class="block text-xs font-bold tracking-luxury uppercase text-gray-400 mb-2">Delivery Date</label>
                    <input type="date" id="delivery-date" class="w-full bg-white border border-gray-200 p-3 text-base text-sb-black focus:border-sb-gold outline-none">
                    <p id="date-error" class="text-xs text-red-500 mt-1 hidden"></p>
                </div>
            </div>
        </div>
        <div class="shrink-0 p-6 border-t border-gray-100 bg-white">
            <div class="flex justify-between items-end mb-6">
                <span class="text-xs font-bold tracking-luxury uppercase text-gray-400">Total</span>
                <span id="cart-subtotal" class="font-serif text-2xl text-sb-black">£0.00</span>
            </div>
            <button id="checkout-btn" class="w-full btn-luxury bg-sb-black text-sb-cream py-4 uppercase tracking-luxury text-xs font-bold border border-sb-black">
                Proceed to Checkout
            </button>
        </div>
    </div>

    <!-- QUICK VIEW MODAL (NEW) -->
    <div id="quick-view-modal" class="fixed inset-0 z-[200] hidden overflow-y-auto">
        <div class="flex min-h-screen items-center justify-center p-4">
            <div class="fixed inset-0 bg-black/80 backdrop-blur-sm transition-opacity" onclick="closeQuickView()"></div>
            <div class="relative w-full max-w-4xl bg-white shadow-2xl overflow-hidden animate-fade-in-up transform transition-all flex flex-col md:flex-row">
                <button onclick="closeQuickView()" class="absolute top-4 right-4 text-gray-400 hover:text-sb-black z-10 p-2"><i class="fas fa-times text-2xl"></i></button>
                
                <!-- Image Side -->
                <div class="w-full md:w-1/2 h-64 md:h-auto bg-gray-100 relative">
                    <img id="qv-image" src="" alt="" class="w-full h-full object-cover">
                </div>
                
                <!-- Details Side -->
                <div class="w-full md:w-1/2 p-8 md:p-12 flex flex-col justify-center bg-sb-cream">
                    <h3 id="qv-title" class="font-serif text-4xl md:text-5xl text-sb-black mb-2 font-normal"></h3>
                    <p id="qv-price" class="text-2xl text-sb-gold font-bold mb-6"></p>
                    <div class="w-12 h-px bg-gray-300 mb-6"></div>
                    <p id="qv-description" class="text-gray-600 font-light text-lg leading-relaxed mb-8"></p>
                    
                    <button id="qv-add-btn" class="shopify-add-btn w-full btn-luxury bg-sb-black text-white py-4 uppercase tracking-luxury text-xs font-bold" data-shopify-id="">
                        Add to Cart
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- CONSULTATION MODAL (FIXED CENTERING) -->
    <div id="consultation-modal" class="fixed inset-0 z-[200] hidden overflow-y-auto">
        <div class="flex min-h-screen items-center justify-center p-4">
            <div class="fixed inset-0 bg-black/80 backdrop-blur-sm transition-opacity" onclick="closeConsultationModal()"></div>
            <div class="relative w-full max-w-lg bg-sb-cream shadow-2xl p-8 md:p-12 animate-fade-in-up transform transition-all">
                <button onclick="closeConsultationModal()" class="absolute top-4 right-4 text-gray-400 hover:text-sb-black transition-colors"><i class="fas fa-times text-2xl"></i></button>
                <div class="text-center mb-8">
                    <span class="text-sb-gold text-xs tracking-super-wide uppercase font-bold mb-2 block">Bespoke Events</span>
                    <h3 class="font-serif text-4xl text-sb-black">Enquire Now</h3>
                </div>
                <form onsubmit="event.preventDefault(); alert('Thank you. We will contact you shortly.'); closeConsultationModal();" class="space-y-6">
                    <div>
                        <label class="block text-xs font-bold tracking-luxury uppercase text-gray-500 mb-2">Event Type</label>
                        <select id="modal-event-type" class="w-full bg-white border border-gray-200 p-3 text-base text-sb-black focus:border-sb-gold outline-none">
                            <option>Wedding</option>
                            <option>Funeral</option>
                            <option>Baby Shower</option>
                            <option>Corporate Event</option>
                            <option>Other</option>
                        </select>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-xs font-bold tracking-luxury uppercase text-gray-500 mb-2">Date</label>
                            <input type="date" class="w-full bg-white border border-gray-200 p-3 text-base text-sb-black focus:border-sb-gold outline-none">
                        </div>
                        <div>
                            <label class="block text-xs font-bold tracking-luxury uppercase text-gray-500 mb-2">Guests (Approx)</label>
                            <input type="number" class="w-full bg-white border border-gray-200 p-3 text-base text-sb-black focus:border-sb-gold outline-none">
                        </div>
                    </div>
                    <div>
                        <label class="block text-xs font-bold tracking-luxury uppercase text-gray-500 mb-2">Venue / Location</label>
                        <input type="text" class="w-full bg-white border border-gray-200 p-3 text-base text-sb-black focus:border-sb-gold outline-none" placeholder="e.g. Gosfield Hall">
                    </div>
                    <div>
                        <label class="block text-xs font-bold tracking-luxury uppercase text-gray-500 mb-2">Your Details</label>
                        <input type="email" class="w-full bg-white border border-gray-200 p-3 text-base text-sb-black focus:border-sb-gold outline-none" placeholder="Email Address">
                    </div>
                    <button type="submit" class="w-full btn-luxury bg-sb-black text-white py-3 uppercase tracking-luxury text-xs font-bold">Send Request</button>
                </form>
            </div>
        </div>
    </div>

    <!-- FLOWER CARE MODAL -->
    <div id="care-modal" class="fixed inset-0 z-[200] hidden overflow-y-auto">
        <div class="flex min-h-screen items-center justify-center p-4">
            <div class="fixed inset-0 bg-black/80 backdrop-blur-sm" onclick="document.getElementById('care-modal').classList.add('hidden')"></div>
            <div class="relative w-full max-w-md bg-white shadow-2xl p-8 animate-fade-in-up transform transition-all">
                <button onclick="document.getElementById('care-modal').classList.add('hidden')" class="absolute top-4 right-4 text-gray-400 hover:text-sb-black"><i class="fas fa-times text-2xl"></i></button>
                <h3 class="font-serif text-3xl text-sb-black mb-6 text-center">Flower Care Guide</h3>
                <ul class="space-y-4 text-base font-light text-gray-600">
                    <li class="flex gap-3"><i class="fas fa-tint text-sb-gold mt-1"></i> <span><strong>Water:</strong> Refresh water every 2 days. Ensure the vase is clean.</span></li>
                    <li class="flex gap-3"><i class="fas fa-cut text-sb-gold mt-1"></i> <span><strong>Trim:</strong> Cut 2cm off the stems at a 45° angle before placing in water.</span></li>
                    <li class="flex gap-3"><i class="fas fa-sun text-sb-gold mt-1"></i> <span><strong>Placement:</strong> Keep away from direct sunlight, drafts, and ripening fruit.</span></li>
                    <li class="flex gap-3"><i class="fas fa-leaf text-sb-gold mt-1"></i> <span><strong>Foliage:</strong> Remove any leaves that sit below the water line to prevent bacteria.</span></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- MAIN CONTENT -->
    <!-- Added min-h-screen to prevent footer flash during transition -->
    <main id="app-content" class="flex-grow min-h-screen">

        <!-- ================= VIEW: HOME ================= -->
        <div id="view-home" class="view-section active-view">
            <!-- Hero Section (More Cinematic) -->
            <section class="relative h-[90vh] overflow-hidden">
                <div class="absolute inset-0">
                    <img src="images/hero.jpg" 
                        alt="Luxury Bouquet" 
                        class="w-full h-full object-cover hero-zoom opacity-90"
                        style="object-position: center 60%;">
                    <!-- Subtle Gradient Overlay -->
                    <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-black/30"></div>
                </div>

                <div class="relative z-10 container mx-auto px-6 h-full flex flex-col justify-center items-center text-center text-sb-cream pt-20">
                    <h2 class="text-xs md:text-sm tracking-[0.3em] uppercase mb-8 font-medium text-sb-gold animate-fade-in">Hand-Tied in Essex • Delivered to London</h2>
                    
                    <h1 class="font-serif text-6xl md:text-8xl lg:text-9xl mb-10 leading-none animate-fade-in-up font-normal">
                        Artistry in <br/><span class="italic font-light text-gold-metallic">Every Bloom</span>
                    </h1>
                    
                    <a href="#seasonal" class="animate-fade-in btn-luxury border border-sb-cream/30 text-sb-cream px-10 py-3 uppercase tracking-luxury text-xs font-bold hover:border-sb-gold">
                        Shop The Collection
                    </a>
                </div>
            </section>

            <!-- Introduction / USP (Refined) -->
            <section class="py-24 bg-sb-black text-sb-cream relative border-t border-white/5">
                <div class="container mx-auto px-6 text-center max-w-2xl">
                    <span class="text-gold-metallic text-2xl mb-6 block reveal"><i class="fas fa-leaf"></i></span>
                    <h2 class="font-serif text-4xl md:text-5xl text-sb-cream mb-8 reveal font-light">A Family Affair</h2>
                    <p class="text-gray-400 leading-relaxed text-xl font-light mb-12 reveal">
                        Welcome to SB Floristry. We are a mother and daughter team bringing bespoke, luxury floral design to weddings, events, and homes across Essex and London. Every arrangement is hand-selected and styled with the care only family can provide.
                    </p>
                    <div class="flex flex-col md:flex-row justify-center gap-12 text-xs font-bold tracking-luxury text-sb-cream uppercase reveal">
                        <div class="flex items-center justify-center"><i class="fas fa-truck mr-3 text-sb-gold"></i> Free Local Delivery (5m)</div>
                        <div class="flex items-center justify-center"><i class="fas fa-heart mr-3 text-sb-gold"></i> Family Owned</div>
                    </div>
                </div>
            </section>

            <!-- Shop by Category (Elegant Grid) -->
            <section class="py-24 bg-sb-cream">
                <div class="container mx-auto px-6">
                    <div class="text-center mb-16 reveal">
                        <h3 class="font-serif text-5xl text-sb-black mb-4 font-light">Explore Our Collections</h3>
                        <div class="w-16 h-px bg-sb-gold mx-auto mt-6"></div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                        <!-- Card 1: Seasonal -->
                        <a href="#seasonal" class="group relative block h-[500px] overflow-hidden cursor-pointer reveal">
                            <img src="images/prod-winter.jpg" alt="Seasonal Collection" class="w-full h-full object-cover transition-transform duration-[1.5s] group-hover:scale-105">
                            <div class="absolute inset-0 bg-black/20 group-hover:bg-black/30 transition-colors duration-500"></div>
                            <div class="absolute inset-0 flex flex-col items-center justify-center text-center p-4">
                                <h4 class="font-serif text-4xl text-sb-cream mb-2 translate-y-4 group-hover:translate-y-0 transition-transform duration-500 font-light">Seasonal Collection</h4>
                                <span class="text-sb-cream text-xs tracking-luxury uppercase border-b border-transparent group-hover:border-sb-cream pb-1 opacity-0 group-hover:opacity-100 transition-all duration-500 delay-100">View Collection</span>
                            </div>
                        </a>

                        <!-- Card 2: Luxury -->
                        <a href="#luxury" class="group relative block h-[500px] overflow-hidden cursor-pointer reveal delay-75">
                            <img src="images/prod-ivory.jpg" alt="Luxury Collection" class="w-full h-full object-cover transition-transform duration-[1.5s] group-hover:scale-105">
                            <div class="absolute inset-0 bg-black/20 group-hover:bg-black/30 transition-colors duration-500"></div>
                            <div class="absolute inset-0 flex flex-col items-center justify-center text-center p-4">
                                <h4 class="font-serif text-4xl text-sb-cream mb-2 translate-y-4 group-hover:translate-y-0 transition-transform duration-500 font-light">Luxury Collection</h4>
                                <span class="text-sb-cream text-xs tracking-luxury uppercase border-b border-transparent group-hover:border-sb-cream pb-1 opacity-0 group-hover:opacity-100 transition-all duration-500 delay-100">View Collection</span>
                            </div>
                        </a>

                        <!-- Card 3: Gothic -->
                        <a href="#gothic" class="group relative block h-[500px] overflow-hidden cursor-pointer reveal delay-150">
                            <img src="images/prod-velvet-darkness.jpg" alt="Gothic Collection" class="w-full h-full object-cover transition-transform duration-[1.5s] group-hover:scale-105">
                            <div class="absolute inset-0 bg-black/40 group-hover:bg-black/50 transition-colors duration-500"></div>
                            <div class="absolute inset-0 flex flex-col items-center justify-center text-center p-4">
                                <h4 class="font-serif text-4xl text-sb-cream mb-2 translate-y-4 group-hover:translate-y-0 transition-transform duration-500 font-light">Gothic Collection</h4>
                                <span class="text-sb-cream text-xs tracking-luxury uppercase border-b border-transparent group-hover:border-sb-cream pb-1 opacity-0 group-hover:opacity-100 transition-all duration-500 delay-100">View Collection</span>
                            </div>
                        </a>

                        <!-- Card 4: Fairy Tale -->
                        <a href="#fairytale" class="group relative block h-[500px] overflow-hidden cursor-pointer reveal delay-200">
                            <img src="images/prod-bibbidi.jpg" alt="Fairy Tale Collection" class="w-full h-full object-cover transition-transform duration-[1.5s] group-hover:scale-105">
                            <div class="absolute inset-0 bg-black/20 group-hover:bg-black/30 transition-colors duration-500"></div>
                            <div class="absolute inset-0 flex flex-col items-center justify-center text-center p-4">
                                <h4 class="font-serif text-4xl text-sb-cream mb-2 translate-y-4 group-hover:translate-y-0 transition-transform duration-500 font-light">Fairy Tale Collection</h4>
                                <span class="text-sb-cream text-xs tracking-luxury uppercase border-b border-transparent group-hover:border-sb-cream pb-1 opacity-0 group-hover:opacity-100 transition-all duration-500 delay-100">View Collection</span>
                            </div>
                        </a>
                    </div>
                </div>
            </section>

            <!-- Florist's Choice Feature -->
            <section class="py-28 bg-sb-black text-sb-cream">
                <div class="container mx-auto px-6">
                    <div class="flex flex-col md:flex-row items-center gap-16 lg:gap-32">
                        <div class="w-full md:w-1/2 text-center md:text-left reveal">
                            <span class="text-sb-gold text-xs tracking-super-wide uppercase font-bold mb-6 block">Florist's Choice</span>
                            <h3 class="font-serif text-6xl md:text-7xl mb-8 leading-tight font-light">Velvet Darkness</h3>
                            <p class="text-gray-400 leading-relaxed text-xl font-light mb-10 max-w-md">
                                A masterclass in midnight elegance. Pairing visceral red velvet roses with ink-black dahlias for a look that is moody, modern, and unashamedly dark.
                            </p>
                            <button class="shopify-add-btn btn-luxury inline-block border border-sb-cream text-sb-cream px-10 py-3 uppercase tracking-luxury text-xs font-bold" data-shopify-id="prod_velvet_darkness">
                                Order Now - £75.00
                            </button>
                        </div>
                        <div class="w-full md:w-1/2 reveal delay-200">
                            <div class="relative aspect-[3/4] overflow-hidden shadow-2xl">
                                <img src="images/prod-velvet-darkness.jpg" alt="Velvet Darkness Bouquet" class="w-full h-full object-cover grayscale hover:grayscale-0 transition-all duration-1000">
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- About Section (Minimalist) -->
            <section class="py-24 bg-sb-cream/50" id="about">
                <div class="container mx-auto px-6">
                    <div class="flex flex-col md:flex-row items-center gap-20">
                        <div class="w-full md:w-1/2 relative reveal">
                            <div class="grid grid-cols-2 gap-4">
                                <div class="mt-12"><img src="images/story-arranging.jpg" class="w-full shadow-lg" alt="Florist"></div>
                                <div><img src="images/story-mother-daughter.jpg" class="w-full shadow-lg" alt="Details"></div>
                            </div>
                        </div>
                        <div class="w-full md:w-1/2 reveal">
                            <h5 class="text-sb-gold font-bold tracking-super-wide text-xs uppercase mb-6">Established 2026</h5>
                            <h2 class="font-serif text-5xl md:text-6xl text-sb-black mb-8 leading-tight font-light">Rooted in Family, <br>Bloomed in Passion.</h2>
                            <div class="w-12 h-px bg-sb-black mb-8"></div>
                            <p class="text-gray-600 mb-6 leading-loose font-light text-lg">
                                SB Floristry began with a deep-rooted passion for flowers that we have both carried for as long as we can remember. What started as arranging flowers for family weddings in our Essex kitchen has grown into a full-service floral studio serving the heart of London and our home county.
                            </p>
                            <ul class="space-y-4 mt-8 text-base font-light text-sb-black">
                                <li class="tracking-wide uppercase text-xs"><i class="fas fa-clock text-sb-gold mr-3"></i> The 5 AM Start</li>
                                <li class="tracking-wide uppercase text-xs"><i class="fas fa-tint text-sb-gold mr-3"></i> 24-Hour Conditioning</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>
        </div>


        <!-- ================= VIEW: FAIRY TALE ================= -->
        <div id="view-fairytale" class="view-section">
            <section class="pt-40 pb-20 bg-sb-cream text-center">
                <span class="text-sb-gold text-xs tracking-super-wide uppercase font-bold mb-4 block">The Collection</span>
                <h1 class="font-serif text-6xl md:text-8xl mb-6 font-light text-sb-black">Fairy Tale</h1>
                <p class="text-xl font-light italic text-gray-500 max-w-2xl mx-auto">Whimsical, enchanting arrangements inspired by magic and romance.</p>
            </section>

            <section class="pb-24 bg-sb-cream">
                <div class="container mx-auto px-6">
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-12">
                        <!-- Product 1: Bibbidi-Bobbidi Boo -->
                        <div class="group relative" data-title="Bibbidi-Bobbidi Boo" data-price="£85.00" data-description="An enchanting mix of Hydrangea and Delphinium, creating a soft blue dreamscape." data-image="images/product-wild-meadow.jpg" data-id="prod_bibbidi">
                            <div class="relative overflow-hidden mb-4 aspect-[4/5] group-image-container">
                                <img src="images/product-wild-meadow.jpg" alt="Bibbidi-Bobbidi Boo" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105">
                                <button onclick="openQuickView(this)" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white/90 text-sb-black w-10 h-10 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20 hover:bg-sb-gold" aria-label="Quick View">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="shopify-add-btn absolute bottom-0 left-0 w-full bg-white/90 backdrop-blur text-sb-black py-4 translate-y-full group-hover:translate-y-0 transition-transform duration-300 font-bold tracking-luxury text-[10px] uppercase hover:bg-sb-black hover:text-white" data-shopify-id="prod_bibbidi">Add to Cart</button>
                            </div>
                            <h4 class="font-serif text-2xl text-sb-black mb-1 font-light">Bibbidi-Bobbidi Boo</h4>
                            <p class="font-medium text-gray-500 text-base">£85.00</p>
                        </div>

                        <!-- Product 2: Once Upon a Dream -->
                        <div class="group relative" data-title="Once Upon a Dream" data-price="£80.00" data-description="Soft pinks and creamy whites, featuring Sweet Avalanche roses and seasonal foliage." data-image="images/product-essex-rose.jpg" data-id="prod_dream">
                            <div class="relative overflow-hidden mb-4 aspect-[4/5] group-image-container">
                                <img src="images/product-essex-rose.jpg" alt="Once Upon a Dream" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105">
                                <button onclick="openQuickView(this)" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white/90 text-sb-black w-10 h-10 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20 hover:bg-sb-gold" aria-label="Quick View">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="shopify-add-btn absolute bottom-0 left-0 w-full bg-white/90 backdrop-blur text-sb-black py-4 translate-y-full group-hover:translate-y-0 transition-transform duration-300 font-bold tracking-luxury text-[10px] uppercase hover:bg-sb-black hover:text-white" data-shopify-id="prod_dream">Add to Cart</button>
                            </div>
                            <h4 class="font-serif text-2xl text-sb-black mb-1 font-light">Once Upon a Dream</h4>
                            <p class="font-medium text-gray-500 text-base">£80.00</p>
                        </div>

                         <!-- Product 3: Mother Knows Best -->
                        <div class="group relative" data-title="Mother Knows Best" data-price="£80.00" data-description="A sophisticated palette of lilacs and purples, designed to impress and express gratitude." data-image="images/product-chelsea.jpg" data-id="prod_mother">
                            <div class="relative overflow-hidden mb-4 aspect-[4/5] group-image-container">
                                <img src="images/product-chelsea.jpg" alt="Mother knows Best" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105">
                                <button onclick="openQuickView(this)" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white/90 text-sb-black w-10 h-10 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20 hover:bg-sb-gold" aria-label="Quick View">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="shopify-add-btn absolute bottom-0 left-0 w-full bg-white/90 backdrop-blur text-sb-black py-4 translate-y-full group-hover:translate-y-0 transition-transform duration-300 font-bold tracking-luxury text-[10px] uppercase hover:bg-sb-black hover:text-white" data-shopify-id="prod_mother">Add to Cart</button>
                            </div>
                            <h4 class="font-serif text-2xl text-sb-black mb-1 font-light">Mother Knows Best</h4>
                            <p class="font-medium text-gray-500 text-base">£80.00</p>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- ================= VIEW: GOTHIC (NEW) ================= -->
        <div id="view-gothic" class="view-section">
            <section class="pt-40 pb-20 bg-sb-black text-center">
                <span class="text-sb-gold text-xs tracking-super-wide uppercase font-bold mb-4 block">The Dark Side</span>
                <h1 class="font-serif text-6xl md:text-8xl mb-6 font-light text-sb-cream">Gothic</h1>
                <p class="text-xl font-light italic text-gray-400 max-w-2xl mx-auto">Dramatic, moody, and undeniably elegant.</p>
            </section>

            <section class="pb-24 bg-sb-black">
                <div class="container mx-auto px-6">
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-12 justify-center">
                         <!-- Product: Velvet Darkness -->
                        <div class="group relative" data-title="Velvet Darkness" data-price="£75.00" data-description="A masterclass in midnight elegance. Pairing visceral red velvet roses with ink-black dahlias." data-image="images/product-pure-elegance.jpg" data-id="prod_velvet_darkness">
                            <div class="relative overflow-hidden mb-4 aspect-[4/5] border border-white/10 group-image-container">
                                <img src="images/product-pure-elegance.jpg" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105">
                                <button onclick="openQuickView(this)" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-sb-cream text-sb-black w-10 h-10 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20 hover:bg-white" aria-label="Quick View">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="shopify-add-btn absolute bottom-0 left-0 w-full bg-sb-cream text-sb-black py-4 translate-y-full group-hover:translate-y-0 transition-transform duration-300 font-bold tracking-luxury text-xs uppercase" data-shopify-id="prod_velvet_darkness">Add to Cart</button>
                            </div>
                            <h4 class="font-serif text-2xl text-sb-cream mb-1 font-light">Velvet Darkness</h4>
                            <p class="font-medium text-sb-gold text-base">£75.00</p>
                        </div>
                        
                        <!-- Placeholder: The Midnight Rose (Florist's Choice) -->
                        <div class="group relative" data-title="The Midnight Rose (Florist's Choice)" data-price="£65.00" data-description="Deep purples and darkest reds combine for a mysterious and alluring arrangement." data-image="images/product-pure-elegance.jpg" data-id="prod_midnight">
                            <div class="relative overflow-hidden mb-4 aspect-[4/5] border border-white/10 group-image-container">
                                <img src="images/product-pure-elegance.jpg" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105">
                                <button onclick="openQuickView(this)" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-sb-cream text-sb-black w-10 h-10 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20 hover:bg-white" aria-label="Quick View">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="shopify-add-btn absolute bottom-0 left-0 w-full bg-sb-cream text-sb-black py-4 translate-y-full group-hover:translate-y-0 transition-transform duration-300 font-bold tracking-luxury text-xs uppercase" data-shopify-id="prod_midnight">Add to Cart</button>
                            </div>
                            <h4 class="font-serif text-2xl text-sb-cream mb-1 font-light">The Midnight Rose (Florist's Choice)</h4>
                            <p class="font-medium text-sb-gold text-base">£65.00</p>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- ================= VIEW: LUXURY ================= -->
        <div id="view-luxury" class="view-section">
            <section class="pt-40 pb-20 bg-sb-black text-center">
                <span class="text-sb-gold text-xs tracking-super-wide uppercase font-bold mb-4 block">The Edition</span>
                <h1 class="font-serif text-6xl md:text-8xl mb-6 font-light text-sb-cream">Luxury</h1>
                <p class="text-xl font-light italic text-gray-400 max-w-2xl mx-auto">Curated for the grandest gestures.</p>
            </section>

            <section class="pb-24 bg-sb-black">
                <div class="container mx-auto px-6">
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-12">
                        
                        <!-- Luxury 1: True Love's Kiss -->
                        <div class="group relative" data-title="True Love's Kiss" data-price="£350.00" data-description="The ultimate gesture. 100 Grand Prix Red Roses, hand-tied to perfection. A showstopper." data-image="images/product-essex-rose.jpg" data-id="prod_truelove">
                            <div class="relative overflow-hidden mb-4 aspect-[4/5] border border-white/10 group-image-container">
                                <img src="images/product-essex-rose.jpg" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105">
                                <button onclick="openQuickView(this)" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-sb-cream text-sb-black w-10 h-10 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20 hover:bg-white" aria-label="Quick View">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="shopify-add-btn absolute bottom-0 left-0 w-full bg-sb-cream text-sb-black py-4 translate-y-full group-hover:translate-y-0 transition-transform duration-300 font-bold tracking-luxury text-[10px] uppercase" data-shopify-id="prod_truelove">Add to Cart</button>
                            </div>
                            <h4 class="font-serif text-2xl text-sb-cream mb-1 font-light">True Love's Kiss</h4>
                            <p class="font-medium text-sb-gold text-base">£350.00</p>
                        </div>

                         <!-- Luxury 2: Velvet Darkness -->
                        <div class="group relative" data-title="Velvet Darkness" data-price="£75.00" data-description="A masterclass in midnight elegance. Pairing visceral red velvet roses with ink-black dahlias." data-image="images/product-pure-elegance.jpg" data-id="prod_velvet_darkness">
                            <div class="relative overflow-hidden mb-4 aspect-[4/5] border border-white/10 group-image-container">
                                <img src="images/product-pure-elegance.jpg" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105">
                                <button onclick="openQuickView(this)" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-sb-cream text-sb-black w-10 h-10 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20 hover:bg-white" aria-label="Quick View">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="shopify-add-btn absolute bottom-0 left-0 w-full bg-sb-cream text-sb-black py-4 translate-y-full group-hover:translate-y-0 transition-transform duration-300 font-bold tracking-luxury text-xs uppercase" data-shopify-id="prod_velvet_darkness">Add to Cart</button>
                            </div>
                            <h4 class="font-serif text-2xl text-sb-cream mb-1 font-light">Velvet Darkness</h4>
                            <p class="font-medium text-sb-gold text-base">£75.00</p>
                        </div>

                        <!-- Luxury 3: Parisian Chic -->
                        <div class="group relative" data-title="Parisian Chic" data-price="£85.00" data-description="Oozing elegance with Peonies and White O'Hara roses. A timeless classic." data-image="images/product-chelsea.jpg" data-id="prod_parisian">
                            <div class="relative overflow-hidden mb-4 aspect-[4/5] border border-white/10 group-image-container">
                                <img src="images/product-chelsea.jpg" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105">
                                <button onclick="openQuickView(this)" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-sb-cream text-sb-black w-10 h-10 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20 hover:bg-white" aria-label="Quick View">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="shopify-add-btn absolute bottom-0 left-0 w-full bg-sb-cream text-sb-black py-4 translate-y-full group-hover:translate-y-0 transition-transform duration-300 font-bold tracking-luxury text-xs uppercase" data-shopify-id="prod_parisian">Add to Cart</button>
                            </div>
                            <h4 class="font-serif text-2xl text-sb-cream mb-1 font-light">Parisian Chic</h4>
                            <p class="font-medium text-sb-gold text-base">£85.00</p>
                        </div>
                        
                        <!-- Luxury 4: Ivory Cloud -->
                        <div class="group relative" data-title="Ivory Cloud" data-price="£70.00" data-description="Massed white roses and delicate Astrantia create a cloud-like texture of pure white." data-image="images/product-pure-elegance.jpg" data-id="prod_ivory">
                            <div class="relative overflow-hidden mb-4 aspect-[4/5] border border-white/10 group-image-container">
                                <img src="images/product-pure-elegance.jpg" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105">
                                <button onclick="openQuickView(this)" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-sb-cream text-sb-black w-10 h-10 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20 hover:bg-white" aria-label="Quick View">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="shopify-add-btn absolute bottom-0 left-0 w-full bg-sb-cream text-sb-black py-4 translate-y-full group-hover:translate-y-0 transition-transform duration-300 font-bold tracking-luxury text-[10px] uppercase" data-shopify-id="prod_ivory">Add to Cart</button>
                            </div>
                            <h4 class="font-serif text-2xl text-sb-cream mb-1 font-light">Ivory Cloud</h4>
                            <p class="font-medium text-sb-gold text-base">£70.00</p>
                        </div>

                    </div>
                </div>
            </section>
        </div>

        <!-- ================= VIEW: SEASONAL ================= -->
        <div id="view-seasonal" class="view-section">
            <section class="pt-40 pb-20 bg-sb-cream text-center">
                <span class="text-sb-gold text-xs tracking-super-wide uppercase font-bold mb-4 block">Signature Blooms</span>
                <h1 class="font-serif text-6xl md:text-8xl mb-6 font-light text-sb-black">Seasonal</h1>
            </section>

            <section class="pb-24 bg-sb-cream">
                <div class="container mx-auto px-6">
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                        
                        <!-- Seasonal 1: Parisian Chic (Also in Luxury) -->
                        <div class="group relative" data-title="Parisian Chic" data-price="£85.00" data-description="Oozing elegance with Peonies and White O'Hara roses." data-image="images/product-chelsea.jpg" data-id="prod_parisian">
                            <div class="relative overflow-hidden mb-4 aspect-[4/5] group-image-container">
                                <img src="images/product-chelsea.jpg" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105">
                                <button onclick="openQuickView(this)" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white/90 text-sb-black w-10 h-10 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20 hover:bg-sb-gold" aria-label="Quick View">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="shopify-add-btn absolute bottom-0 left-0 w-full bg-white/90 backdrop-blur text-sb-black py-4 translate-y-full group-hover:translate-y-0 transition-transform duration-300 font-bold tracking-luxury text-[10px] uppercase hover:bg-sb-black hover:text-white" data-shopify-id="prod_parisian">Add</button>
                            </div>
                            <h4 class="font-serif text-2xl text-sb-black mb-1 font-light">Parisian Chic</h4>
                            <p class="text-base text-gray-500">£85.00</p>
                        </div>

                        <!-- Seasonal 2: Velvet Gala -->
                        <div class="group relative" data-title="The Velvet Gala" data-price="£45.00" data-description="A vibrant mix of multi-toned carnations, offering long-lasting color and texture." data-image="images/product-wild-meadow.jpg" data-id="prod_velvetgala">
                            <div class="relative overflow-hidden mb-4 aspect-[4/5] group-image-container">
                                <img src="images/product-wild-meadow.jpg" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105">
                                <button onclick="openQuickView(this)" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white/90 text-sb-black w-10 h-10 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20 hover:bg-sb-gold" aria-label="Quick View">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="shopify-add-btn absolute bottom-0 left-0 w-full bg-white/90 backdrop-blur text-sb-black py-4 translate-y-full group-hover:translate-y-0 transition-transform duration-300 font-bold tracking-luxury text-[10px] uppercase hover:bg-sb-black hover:text-white" data-shopify-id="prod_velvetgala">Add</button>
                            </div>
                            <h4 class="font-serif text-2xl text-sb-black mb-1 font-light">The Velvet Gala</h4>
                            <p class="text-base text-gray-500">£45.00</p>
                        </div>
                        
                        <!-- Seasonal 3: Serene Blush -->
                        <div class="group relative" data-title="Serene Blush" data-price="£55.00" data-description="Delicate pink and cream spray roses for a soft, romantic gesture." data-image="images/product-essex-rose.jpg" data-id="prod_serene">
                            <div class="relative overflow-hidden mb-4 aspect-[4/5] group-image-container">
                                <img src="images/product-essex-rose.jpg" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105">
                                <button onclick="openQuickView(this)" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white/90 text-sb-black w-10 h-10 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20 hover:bg-sb-gold" aria-label="Quick View">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="shopify-add-btn absolute bottom-0 left-0 w-full bg-white/90 backdrop-blur text-sb-black py-4 translate-y-full group-hover:translate-y-0 transition-transform duration-300 font-bold tracking-luxury text-[10px] uppercase hover:bg-sb-black hover:text-white" data-shopify-id="prod_serene">Add</button>
                            </div>
                            <h4 class="font-serif text-2xl text-sb-black mb-1 font-light">Serene Blush</h4>
                            <p class="text-base text-gray-500">£55.00</p>
                        </div>
                        
                         <!-- Seasonal 4: Winter Delight -->
                        <div class="group relative" data-title="Winter Delight" data-price="£65.00" data-description="Rich seasonal blooms bringing warmth and depth to any room." data-image="images/product-pure-elegance.jpg" data-id="prod_winter">
                            <div class="relative overflow-hidden mb-4 aspect-[4/5] group-image-container">
                                <img src="images/product-pure-elegance.jpg" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105">
                                <button onclick="openQuickView(this)" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white/90 text-sb-black w-10 h-10 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20 hover:bg-sb-gold" aria-label="Quick View">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="shopify-add-btn absolute bottom-0 left-0 w-full bg-white/90 backdrop-blur text-sb-black py-4 translate-y-full group-hover:translate-y-0 transition-transform duration-300 font-bold tracking-luxury text-[10px] uppercase hover:bg-sb-black hover:text-white" data-shopify-id="prod_winter">Add</button>
                            </div>
                            <h4 class="font-serif text-2xl text-sb-black mb-1 font-light">Winter Delight</h4>
                            <p class="text-base text-gray-500">£65.00</p>
                        </div>

                         <!-- Seasonal 5: Single Kiss -->
                        <div class="group relative" data-title="Single Kiss" data-price="£12.99" data-description="A single, perfect Red Rose. Simple, classic, meaningful." data-image="images/product-essex-rose.jpg" data-id="prod_singlekiss">
                            <div class="relative overflow-hidden mb-4 aspect-[4/5] group-image-container">
                                <img src="images/product-essex-rose.jpg" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105">
                                <button onclick="openQuickView(this)" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white/90 text-sb-black w-10 h-10 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20 hover:bg-sb-gold" aria-label="Quick View">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="shopify-add-btn absolute bottom-0 left-0 w-full bg-white/90 backdrop-blur text-sb-black py-4 translate-y-full group-hover:translate-y-0 transition-transform duration-300 font-bold tracking-luxury text-[10px] uppercase hover:bg-sb-black hover:text-white" data-shopify-id="prod_singlekiss">Add</button>
                            </div>
                            <h4 class="font-serif text-2xl text-sb-black mb-1 font-light">Single Kiss</h4>
                            <p class="text-base text-gray-500">£12.99</p>
                        </div>

                        <!-- Seasonal 6: Jaded Bloom (NEW) -->
                        <div class="group relative" data-title="Jaded Bloom" data-price="£50.00" data-description="A sophisticated, modern arrangement with a touch of mystery." data-image="images/prod-jaded-bloom.jpg" data-id="prod_jaded">
                            <div class="relative overflow-hidden mb-4 aspect-[4/5] group-image-container">
                                <img src="images/prod-jaded-bloom.jpg" alt="Jaded Bloom" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105">
                                <button onclick="openQuickView(this)" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white/90 text-sb-black w-10 h-10 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20 hover:bg-sb-gold" aria-label="Quick View">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="shopify-add-btn absolute bottom-0 left-0 w-full bg-white/90 backdrop-blur text-sb-black py-4 translate-y-full group-hover:translate-y-0 transition-transform duration-300 font-bold tracking-luxury text-[10px] uppercase hover:bg-sb-black hover:text-white" data-shopify-id="prod_jaded">Add to Cart</button>
                            </div>
                            <h4 class="font-serif text-2xl text-sb-black mb-1 font-light">Jaded Bloom</h4>
                            <p class="text-base text-gray-500">£50.00</p>
                        </div>

                        <!-- Seasonal 7: Bloom Blossom (NEW) -->
                        <div class="group relative" data-title="Bloom Blossom" data-price="£55.00" data-description="Fresh, vibrant, and full of life. A true celebration of the season." data-image="images/prod-bloom-blossom.jpg" data-id="prod_bloom_blossom">
                            <div class="relative overflow-hidden mb-4 aspect-[4/5] group-image-container">
                                <img src="images/prod-bloom-blossom.jpg" alt="Bloom Blossom" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105">
                                <button onclick="openQuickView(this)" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white/90 text-sb-black w-10 h-10 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20 hover:bg-sb-gold" aria-label="Quick View">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="shopify-add-btn absolute bottom-0 left-0 w-full bg-white/90 backdrop-blur text-sb-black py-4 translate-y-full group-hover:translate-y-0 transition-transform duration-300 font-bold tracking-luxury text-[10px] uppercase hover:bg-sb-black hover:text-white" data-shopify-id="prod_bloom_blossom">Add to Cart</button>
                            </div>
                            <h4 class="font-serif text-2xl text-sb-black mb-1 font-light">Bloom Blossom</h4>
                            <p class="text-base text-gray-500">£55.00</p>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- ================= VIEW: WEDDINGS (EVENTS) ================= -->
        <div id="view-weddings" class="view-section">
            <section class="relative h-[70vh] overflow-hidden">
                <div class="absolute inset-0">
                    <img src="images/weddings-bg.jpg" alt="Weddings Banner" class="w-full h-full object-cover">
                    <div class="absolute inset-0 bg-black/60"></div>
                </div>
                <div class="relative z-10 container mx-auto px-6 h-full flex flex-col justify-center items-center text-center text-sb-cream">
                    <h1 class="font-serif text-6xl md:text-8xl mb-6 font-light">Weddings & Events</h1>
                    <p class="text-lg md:text-xl font-light italic max-w-2xl leading-relaxed opacity-80">From intimate ceremonies in Essex countryside chapels to grand London ballroom receptions.</p>
                </div>
            </section>
            
            <section class="py-24 bg-sb-cream text-center">
                <div class="container mx-auto px-6 max-w-3xl">
                    <h2 class="font-serif text-4xl text-sb-black mb-8 font-light">Let us create your floral backdrop.</h2>
                    <p class="text-gray-600 leading-relaxed text-xl font-light mb-12">
                        We work closely with couples to design floral landscapes that reflect their unique story. We handle everything from the initial consultation to the final installation on the big day.
                    </p>
                    <button onclick="openConsultationModal('Wedding')" class="btn-luxury border border-sb-black text-sb-black px-10 py-3 uppercase tracking-luxury text-xs font-bold inline-block">
                        Enquire for availability
                    </button>
                </div>
            </section>
        </div>

        <!-- ================= VIEW: FUNERALS ================= -->
        <div id="view-funerals" class="view-section">
            <section class="pt-40 pb-20 bg-sb-cream text-center">
                <span class="text-sb-gold text-xs tracking-super-wide uppercase font-bold mb-4 block">In Loving Memory</span>
                <h1 class="font-serif text-6xl md:text-8xl mb-6 font-light text-sb-black">Funerals & Sympathy</h1>
                <p class="text-xl font-light italic text-gray-500 max-w-2xl mx-auto">Elegant, respectful tributes designed to honor your loved ones with grace.</p>
            </section>
            <section class="pb-24 bg-sb-cream">
                <div class="container mx-auto px-6 max-w-3xl text-center">
                    <p class="text-gray-600 leading-relaxed text-xl font-light mb-12">
                        We understand the importance of saying goodbye beautifully. Our sympathy arrangements are created with compassion and care, using seasonal blooms to reflect the personality and spirit of the departed.
                    </p>
                    <button onclick="openConsultationModal('Funeral')" class="btn-luxury border border-sb-black text-sb-black px-10 py-3 uppercase tracking-luxury text-xs font-bold inline-block">Enquire Now</button>
                </div>
            </section>
        </div>

        <!-- ================= VIEW: BABY SHOWERS ================= -->
        <div id="view-babyshowers" class="view-section">
            <section class="pt-40 pb-20 bg-sb-cream text-center">
                <span class="text-sb-gold text-xs tracking-super-wide uppercase font-bold mb-4 block">New Beginnings</span>
                <h1 class="font-serif text-6xl md:text-8xl mb-6 font-light text-sb-black">Baby Showers</h1>
                <p class="text-xl font-light italic text-gray-500 max-w-2xl mx-auto">Whimsical floral installations to welcome new life.</p>
            </section>
            <section class="pb-24 bg-sb-cream">
                <div class="container mx-auto px-6 max-w-3xl text-center">
                    <p class="text-gray-600 leading-relaxed text-xl font-light mb-12">
                        From balloon arches with integrated florals to delicate table centers, we create the perfect backdrop for celebrating the upcoming arrival.
                    </p>
                    <button onclick="openConsultationModal('Baby Shower')" class="btn-luxury border border-sb-black text-sb-black px-10 py-3 uppercase tracking-luxury text-xs font-bold inline-block">Enquire Now</button>
                </div>
            </section>
        </div>

        <!-- ================= VIEW: GENDER REVEAL ================= -->
        <div id="view-genderreveal" class="view-section">
            <section class="pt-40 pb-20 bg-sb-cream text-center">
                <span class="text-sb-gold text-xs tracking-super-wide uppercase font-bold mb-4 block">Pink or Blue?</span>
                <h1 class="font-serif text-6xl md:text-8xl mb-6 font-light text-sb-black">Gender Reveal</h1>
            </section>
            <section class="pb-24 bg-sb-cream">
                <div class="container mx-auto px-6 max-w-3xl text-center">
                    <p class="text-gray-600 leading-relaxed text-xl font-light mb-12">
                        Mark the big reveal with creative floral designs. Whether you want a neutral palette that bursts into colour or a classic split theme, we bring the excitement to life.
                    </p>
                    <button onclick="openConsultationModal('Gender Reveal')" class="btn-luxury border border-sb-black text-sb-black px-10 py-3 uppercase tracking-luxury text-xs font-bold inline-block">Enquire Now</button>
                </div>
            </section>
        </div>

        <!-- ================= VIEW: WORK EVENTS ================= -->
        <div id="view-workevents" class="view-section">
            <section class="pt-40 pb-20 bg-sb-cream text-center">
                <span class="text-sb-gold text-xs tracking-super-wide uppercase font-bold mb-4 block">Corporate</span>
                <h1 class="font-serif text-6xl md:text-8xl mb-6 font-light text-sb-black">Work Events</h1>
            </section>
            <section class="pb-24 bg-sb-cream">
                <div class="container mx-auto px-6 max-w-3xl text-center">
                    <p class="text-gray-600 leading-relaxed text-xl font-light mb-12">
                        Statement pieces for offices, galas, and brand activations that leave a lasting impression on your clients and team.
                    </p>
                    <button onclick="openConsultationModal('Corporate Event')" class="btn-luxury border border-sb-black text-sb-black px-10 py-3 uppercase tracking-luxury text-xs font-bold inline-block">Enquire Now</button>
                </div>
            </section>
        </div>

    </main>

    <!-- INSTAGRAM FEED (Placeholder) -->
    <section class="py-16 bg-white border-t border-gray-100">
        <div class="container mx-auto px-6 text-center">
            <a href="#" class="text-sm font-bold tracking-luxury uppercase text-gray-400 hover:text-sb-gold transition-colors mb-8 block"><i class="fab fa-instagram mr-2"></i> Follow Us @SBFloristry</a>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-2">
                <div class="aspect-square bg-gray-100 group relative overflow-hidden">
                    <img src="images/gallery-1.jpg" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110">
                    <div class="absolute inset-0 bg-black/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                </div>
                <div class="aspect-square bg-gray-100 group relative overflow-hidden">
                    <img src="images/gallery-2.jpg" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110">
                    <div class="absolute inset-0 bg-black/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                </div>
                <div class="aspect-square bg-gray-100 group relative overflow-hidden">
                    <img src="images/gallery-3.jpg" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110">
                    <div class="absolute inset-0 bg-black/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                </div>
                <div class="aspect-square bg-gray-100 group relative overflow-hidden">
                    <img src="images/gallery-4.jpg" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110">
                    <div class="absolute inset-0 bg-black/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- CONTACT (RESTORED DETAILED FORM) -->
    <section class="py-24 bg-sb-black text-sb-cream" id="contact-section">
        <div class="container mx-auto px-6 max-w-4xl">
            <div class="text-center mb-12 reveal">
                <h3 class="font-serif text-5xl md:text-6xl text-sb-cream mb-4 font-light">Start Your Floral Journey</h3>
                <p class="font-light text-gray-400 text-lg">Tell us about your event or custom request.</p>
            </div>
            <form class="space-y-8 reveal" onsubmit="event.preventDefault(); alert('Thank you for your inquiry. We will be in touch shortly.');">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="space-y-1">
                        <label class="text-xs font-bold tracking-luxury uppercase text-sb-gold">Name</label>
                        <input type="text" class="w-full bg-transparent border-b border-gray-700 focus:border-sb-gold outline-none py-2 transition-colors text-sb-cream placeholder-gray-600 text-base">
                    </div>
                    <div class="space-y-1">
                        <label class="text-xs font-bold tracking-luxury uppercase text-sb-gold">Email</label>
                        <input type="email" class="w-full bg-transparent border-b border-gray-700 focus:border-sb-gold outline-none py-2 transition-colors text-sb-cream placeholder-gray-600 text-base">
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="space-y-1">
                        <label class="text-xs font-bold tracking-luxury uppercase text-sb-gold">Event Date (Optional)</label>
                        <input type="date" class="w-full bg-transparent border-b border-gray-700 focus:border-sb-gold outline-none py-2 transition-colors text-sb-cream text-gray-400 text-base">
                    </div>
                    <div class="space-y-1">
                        <label class="text-xs font-bold tracking-luxury uppercase text-sb-gold">Interest</label>
                        <select class="w-full bg-transparent border-b border-gray-700 focus:border-sb-gold outline-none py-2 transition-colors text-sb-cream text-base">
                            <option class="bg-sb-black">Weddings</option>
                            <option class="bg-sb-black">Events</option>
                            <option class="bg-sb-black">Subscription</option>
                            <option class="bg-sb-black">Bespoke Order</option>
                        </select>
                    </div>
                </div>
                <div class="space-y-1">
                    <label class="text-xs font-bold tracking-luxury uppercase text-sb-gold">Message</label>
                    <textarea rows="4" class="w-full bg-transparent border-b border-gray-700 focus:border-sb-gold outline-none py-2 transition-colors text-sb-cream placeholder-gray-600 text-base"></textarea>
                </div>
                <div class="text-center pt-8">
                    <button type="submit" class="btn-luxury border border-sb-cream text-sb-cream px-16 py-4 uppercase tracking-luxury text-xs font-bold inline-block">
                        Send Inquiry
                    </button>
                </div>
            </form>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-sb-black text-gray-500 pt-16 pb-8 border-t border-white/5 text-center">
        <div class="container mx-auto px-6">
            <div class="mb-12">
                <h3 class="font-serif text-3xl text-sb-cream mb-4 font-light tracking-widest">SB FLORISTRY</h3>
                <!-- TRUST BADGES -->
                <div class="flex justify-center gap-8 mt-8 text-gray-600">
                    <div class="flex flex-col items-center">
                        <i class="fas fa-lock text-xl mb-2 text-sb-gold"></i>
                        <span class="text-xs uppercase tracking-widest">Secure Payment</span>
                    </div>
                    <div class="flex flex-col items-center">
                        <i class="fas fa-truck text-xl mb-2 text-sb-gold"></i>
                        <span class="text-xs uppercase tracking-widest">Hand Delivered</span>
                    </div>
                    <div class="flex flex-col items-center">
                        <i class="fas fa-leaf text-xl mb-2 text-sb-gold"></i>
                        <span class="text-xs uppercase tracking-widest">Freshness Guaranteed</span>
                    </div>
                </div>
            </div>
            
            <div class="flex justify-center space-x-8 mb-10 text-xs tracking-luxury uppercase font-bold text-sb-gold">
                <a href="#home">Home</a>
                <a href="#seasonal">Shop</a>
                <a href="#contact">Contact</a>
                <button onclick="document.getElementById('care-modal').classList.remove('hidden')">Flower Care</button>
            </div>
            <p class="text-xs tracking-widest uppercase opacity-50">&copy; 2026 SB Floristry. Made in Essex.</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script>
        // ROUTING & VIEW LOGIC
        // -------------------------------------------------------------
        
        function handleRoute() {
            // 1. Get current hash (default to 'home' if empty)
            let hash = window.location.hash.substring(1) || 'home';
            
            // 2. Normalize: if hash is something like 'contact', map to home so we see the footer section
            if (hash === 'contact') {
                 // We let the browser scroll to #contact which is on every page footer, 
                 // but we ensure the 'home' view is active so the main content is visible.
                 hash = 'home';
            }

            // 3. Define mapping of hash -> view ID
            // Note: Keys must match the hrefs in your nav (without #)
            const viewMap = {
                'home': 'view-home',
                'fairytale': 'view-fairytale',
                'seasonal': 'view-seasonal',
                'weddings': 'view-weddings',
                'luxury': 'view-luxury',
                'gothic': 'view-gothic',
                'funerals': 'view-funerals',
                'babyshowers': 'view-babyshowers',
                'genderreveal': 'view-genderreveal',
                'workevents': 'view-workevents'
            };

            // 4. Get active view ID
            const activeViewId = viewMap[hash] || 'view-home';

            // 5. Hide all views, Show active view
            document.querySelectorAll('.view-section').forEach(section => {
                if (section.id === activeViewId) {
                    // Smooth Transition: Scroll to top FIRST, then fade in
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                    
                    // Small delay to allow scroll to start before fading in
                    setTimeout(() => {
                        section.classList.add('active-view');
                    }, 150);
                    
                } else {
                    section.classList.remove('active-view');
                }
            });
        }

        // Listen for hash changes
        window.addEventListener('hashchange', handleRoute);
        // Initial load
        window.addEventListener('DOMContentLoaded', handleRoute);


        // MODALS & UI LOGIC
        // -------------------------------------------------------------
        function openConsultationModal(eventType) {
            const modal = document.getElementById('consultation-modal');
            const select = document.getElementById('modal-event-type');
            if (modal && select) {
                if(eventType) select.value = eventType;
                modal.classList.remove('hidden');
            }
        }

        function closeConsultationModal() {
            const modal = document.getElementById('consultation-modal');
            if (modal) modal.classList.add('hidden');
        }

        // QUICK VIEW LOGIC
        function openQuickView(element) {
            const container = element.closest('.group');
            if (!container) return;

            const title = container.getAttribute('data-title');
            const price = container.getAttribute('data-price');
            const desc = container.getAttribute('data-description');
            const imgSrc = container.getAttribute('data-image');
            const id = container.getAttribute('data-id');

            document.getElementById('qv-title').innerText = title;
            document.getElementById('qv-price').innerText = price;
            document.getElementById('qv-description').innerText = desc || "A beautiful arrangement.";
            document.getElementById('qv-image').src = imgSrc;
            document.getElementById('qv-add-btn').setAttribute('data-shopify-id', id);

            document.getElementById('quick-view-modal').classList.remove('hidden');
        }

        function closeQuickView() {
            document.getElementById('quick-view-modal').classList.add('hidden');
        }

        // Mobile Menu Accordion Logic
        document.querySelectorAll('.mobile-accordion-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                btn.classList.toggle('active');
            });
        });


        // SHOPIFY BUY SDK LOGIC
        // -------------------------------------------------------------
        
        const shopifyConfig = {
            domain: 'sb-floristry.myshopify.com', 
            storefrontAccessToken: '35527e42586bf1abcce2dda69206eec9' 
        };
        
        let debounceTimer;

        // Helper to fetch directly from Storefront API
        async function shopifyFetch(query, variables = {}) {
            try {
                const response = await fetch(`https://${shopifyConfig.domain}/api/2024-01/graphql.json`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Shopify-Storefront-Access-Token': shopifyConfig.storefrontAccessToken
                    },
                    body: JSON.stringify({ query, variables })
                });
                return await response.json();
            } catch (error) {
                console.error("Shopify Fetch Error:", error);
                throw error;
            }
        }

        // Initialize Cart
        async function initCart() {
            let cartId = localStorage.getItem('shopify_cart_id');
            if (!cartId) return null;
            
            const query = `
                query($id: ID!) {
                  cart(id: $id) {
                    id
                    checkoutUrl
                    totalQuantity
                    note
                    attributes { key value }
                    cost {
                        subtotalAmount { amount currencyCode }
                    }
                    lines(first: 10) {
                        edges {
                            node {
                                id
                                quantity
                                merchandise {
                                    ... on ProductVariant {
                                        id
                                        title
                                        price { amount currencyCode }
                                        image { url }
                                        product { title }
                                    }
                                }
                            }
                        }
                    }
                  }
                }
            `;
            
            const result = await shopifyFetch(query, { id: cartId });
            
            if (result.data && result.data.cart) {
                updateCartUI(result.data.cart);
                // Pre-fill inputs from saved cart data
                const noteInput = document.getElementById('cart-note');
                const dateInput = document.getElementById('delivery-date');
                
                if (noteInput && result.data.cart.note) {
                    noteInput.value = result.data.cart.note;
                }
                
                if (dateInput && result.data.cart.attributes) {
                    const dateAttr = result.data.cart.attributes.find(a => a.key === 'Requested Delivery Date');
                    if (dateAttr) dateInput.value = dateAttr.value;
                }
                
                return result.data.cart;
            } else {
                localStorage.removeItem('shopify_cart_id');
                return null;
            }
        }
        
        // Create a new cart
        async function createCart() {
            const query = `mutation { cartCreate { cart { id checkoutUrl } } }`;
            const result = await shopifyFetch(query);
            if (result.data && result.data.cartCreate && result.data.cartCreate.cart) {
                const cart = result.data.cartCreate.cart;
                localStorage.setItem('shopify_cart_id', cart.id);
                return cart;
            }
            throw new Error("Failed to create cart");
        }

        // Update Cart Attributes (Note & Date)
        async function updateCartAttributes(note, date) {
            const cartId = localStorage.getItem('shopify_cart_id');
            if (!cartId) return;

            const query = `
                mutation updateCart($cartId: ID!, $note: String, $attributes: [AttributeInput!]) {
                    cartNoteUpdate(cartId: $cartId, note: $note) {
                        cart { id }
                    }
                    cartAttributesUpdate(cartId: $cartId, attributes: $attributes) {
                        cart { id }
                    }
                }
            `;

            // Prepare attributes array. Only add date if it exists.
            const attributes = [];
            if (date) {
                attributes.push({ key: "Requested Delivery Date", value: date });
            }

            try {
                await shopifyFetch(query, {
                    cartId: cartId,
                    note: note || "", 
                    attributes: attributes
                });
                console.log("Cart updated with note/date");
                return true;
            } catch (e) {
                console.error("Failed to update attributes", e);
                return false;
            }
        }

        // Handle Date/Note input changes with validation
        function handleCartInputUpdate() {
            const note = document.getElementById('cart-note')?.value;
            const dateInput = document.getElementById('delivery-date');
            const dateError = document.getElementById('date-error');
            
            let isValidDate = true;

            if (dateInput && dateInput.value) {
                const selectedDate = new Date(dateInput.value);
                const day = selectedDate.getDay(); // 0 = Sunday
                const today = new Date().toISOString().split('T')[0];
                
                // Reset error
                dateError.classList.add('hidden');
                dateError.innerText = "";
                dateInput.classList.remove('border-red-500');

                // 1. Check if date is in the past
                if (dateInput.value < today) {
                    dateError.innerText = "Please select a date in the future.";
                    dateError.classList.remove('hidden');
                    dateInput.classList.add('border-red-500');
                    isValidDate = false;
                }
                // 2. Check for Sunday
                else if (day === 0) {
                    dateError.innerText = "We do not deliver on Sundays. Please select another date.";
                    dateError.classList.remove('hidden');
                    dateInput.classList.add('border-red-500');
                    isValidDate = false;
                }
            }

            // Only save to Shopify if date is valid (or empty/cleared)
            if (isValidDate) {
                clearTimeout(debounceTimer);
                debounceTimer = setTimeout(() => {
                    updateCartAttributes(note, dateInput?.value);
                }, 500); 
            }
        }

        // SMART ADD TO CART: Converts Product ID -> Variant ID -> Add to Cart
        async function addToCart(rawProductId) {
            try {
                // 1. Convert raw ID (12345) to Shopify Global ID (gid://shopify/Product/12345)
                // We use btoa() to encode it to Base64 as required by the SDK
                const globalProductId = btoa(`gid://shopify/Product/${rawProductId}`);

                // 2. Fetch the product to get the correct Variant ID
                const productQuery = `
                    query($id: ID!) {
                      product(id: $id) {
                        variants(first: 1) {
                          nodes {
                            id
                          }
                        }
                      }
                    }
                `;
                
                let productResult = await shopifyFetch(productQuery, { id: globalProductId }); // Fixed to use globalProductId
                
                if (!productResult.data || !productResult.data.product) {
                     // Fallback logic for raw GIDs
                     const rawGid = `gid://shopify/Product/${rawProductId}`;
                     productResult = await shopifyFetch(productQuery, { id: rawGid });
                     
                     if (!productResult.data || !productResult.data.product) {
                        throw new Error("Product not found");
                     }
                }
                
                const variantId = productResult.data.product.variants.nodes[0].id;
                
                // 3. Get or Create Cart
                let cart = await initCart();
                if (!cart) {
                    cart = await createCart();
                }
                
                // 4. Add Line Item
                const addLineQuery = `
                    mutation($cartId: ID!, $lines: [CartLineInput!]!) {
                      cartLinesAdd(cartId: $cartId, lines: $lines) {
                        cart {
                          id
                          totalQuantity
                          checkoutUrl
                          cost { subtotalAmount { amount currencyCode } }
                          lines(first: 10) {
                            edges {
                                node {
                                    id
                                    quantity
                                    merchandise {
                                        ... on ProductVariant {
                                            id
                                            title
                                            price { amount currencyCode }
                                            image { url }
                                            product { title }
                                        }
                                    }
                                }
                            }
                        }
                        }
                      }
                    }
                `;
                
                const addResult = await shopifyFetch(addLineQuery, {
                    cartId: cart.id,
                    lines: [{ merchandiseId: variantId, quantity: 1 }]
                });
                
                if (addResult.data && addResult.data.cartLinesAdd && addResult.data.cartLinesAdd.cart) {
                    updateCartUI(addResult.data.cartLinesAdd.cart);
                    if (window.openCart) window.openCart();
                    return true;
                }
                return false;

            } catch (e) {
                console.error("Error adding to cart:", e);
                alert("Simulated Add: Product ID '" + rawProductId + "' is a placeholder. In a real store, this would add to the cart.");
                return false;
            }
        }

        async function updateLineItem(lineId, quantity) {
            const cartId = localStorage.getItem('shopify_cart_id');
            if(!cartId) return;

            const query = `
                mutation($cartId: ID!, $lines: [CartLineUpdateInput!]!) {
                    cartLinesUpdate(cartId: $cartId, lines: $lines) {
                        cart {
                            id
                            totalQuantity
                            checkoutUrl
                            cost { subtotalAmount { amount currencyCode } }
                            lines(first: 10) {
                                edges {
                                    node {
                                        id
                                        quantity
                                        merchandise {
                                            ... on ProductVariant {
                                                id
                                                title
                                                price { amount currencyCode }
                                                image { url }
                                                product { title }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            `;
            
            const result = await shopifyFetch(query, {
                cartId: cartId,
                lines: [{ id: lineId, quantity: quantity }]
            });

            if(result.data && result.data.cartLinesUpdate) {
                updateCartUI(result.data.cartLinesUpdate.cart);
            }
        }

        async function removeLineItem(lineId) {
             const cartId = localStorage.getItem('shopify_cart_id');
            if(!cartId) return;

            const query = `
                mutation($cartId: ID!, $lineIds: [ID!]!) {
                    cartLinesRemove(cartId: $cartId, lineIds: $lineIds) {
                        cart {
                            id
                            totalQuantity
                            checkoutUrl
                            cost { subtotalAmount { amount currencyCode } }
                            lines(first: 10) {
                                edges {
                                    node {
                                        id
                                        quantity
                                        merchandise {
                                            ... on ProductVariant {
                                                id
                                                title
                                                price { amount currencyCode }
                                                image { url }
                                                product { title }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            `;
            
            const result = await shopifyFetch(query, {
                cartId: cartId,
                lineIds: [lineId]
            });

            if(result.data && result.data.cartLinesRemove) {
                updateCartUI(result.data.cartLinesRemove.cart);
            }
        }

        function updateCartUI(cart) {
            // Update Badge
            const badge = document.getElementById('cart-count');
            if (badge) {
                badge.innerText = cart.totalQuantity;
                badge.classList.remove('opacity-0');
                if(cart.totalQuantity > 0) {
                    badge.classList.add('scale-150');
                    setTimeout(() => badge.classList.remove('scale-150'), 200);
                }
            }

            // Update Side Cart HTML
            const cartContainer = document.getElementById('cart-items-container');
            const subtotalEl = document.getElementById('cart-subtotal');
            const checkoutBtn = document.getElementById('checkout-btn');
            const upsellSection = document.getElementById('upsell-section');
            const shippingBar = document.getElementById('shipping-bar');
            const shippingMessage = document.getElementById('shipping-message');
            const cartExtras = document.getElementById('cart-extras');

            if (cartContainer && cart.cost) {
                 const amount = parseFloat(cart.cost.subtotalAmount.amount);
                 if (subtotalEl) subtotalEl.innerText = `£${amount.toFixed(2)}`;
                 
                 // Show/Hide Upsell and Extras based on items
                 const hasItems = cart.lines.edges.length > 0;

                 if (hasItems && upsellSection) {
                     upsellSection.classList.remove('hidden');
                 } else if (upsellSection) {
                     upsellSection.classList.add('hidden');
                 }

                 if (hasItems && cartExtras) {
                    cartExtras.classList.remove('hidden');
                 } else if (cartExtras) {
                    cartExtras.classList.add('hidden');
                 }

                 // Update Free Delivery Bar
                 const freeDeliveryThreshold = 60;
                 if (shippingBar && shippingMessage) {
                     let percentage = (amount / freeDeliveryThreshold) * 100;
                     if (percentage > 100) percentage = 100;
                     
                     shippingBar.style.width = `${percentage}%`;
                     
                     if (amount >= freeDeliveryThreshold) {
                         shippingBar.classList.add('bg-green-500');
                         shippingBar.classList.remove('bg-sb-gold');
                         shippingMessage.innerHTML = 'You have unlocked <span class="text-green-600">Free Delivery!</span>';
                     } else {
                         shippingBar.classList.add('bg-sb-gold');
                         shippingBar.classList.remove('bg-green-500');
                         const remaining = (freeDeliveryThreshold - amount).toFixed(2);
                         shippingMessage.innerHTML = `Spend <span class="text-sb-gold">£${remaining}</span> more for Free Delivery`;
                     }
                 }
            }

            // Bind Checkout Button - UPDATED LOGIC
            if (checkoutBtn) {
                // Clone button to remove old listeners if any
                const newBtn = checkoutBtn.cloneNode(true);
                checkoutBtn.parentNode.replaceChild(newBtn, checkoutBtn);
                
                // If cart empty, redirect to shop. Else checkout.
                if (cart.lines.edges.length === 0) {
                     newBtn.innerText = "Browse Seasonal Collection";
                     newBtn.onclick = () => {
                         window.closeCart();
                         document.getElementById('shop').scrollIntoView({ behavior: 'smooth' });
                     };
                } else if (cart.checkoutUrl) {
                    newBtn.innerText = "Proceed to Checkout";
                    
                    newBtn.onclick = async () => {
                        const noteInput = document.getElementById('cart-note');
                        const dateInput = document.getElementById('delivery-date');
                        const note = noteInput?.value.trim();
                        const date = dateInput?.value;

                        // 1. Mandatory Date Check
                        if (!date) {
                            alert("Please select a delivery date to proceed.");
                            dateInput.classList.add('border-red-500');
                            dateInput.focus();
                            return;
                        }

                        // 2. Strict Date Validation (Past Check only now, since Mon-Sun delivery allowed)
                        const today = new Date().toISOString().split('T')[0];
                        
                        if (date < today) {
                             alert("The selected delivery date is in the past. Please choose a valid date.");
                             dateInput.focus();
                             return;
                        }
                        
                        // Proceed
                        const originalText = newBtn.innerText;
                        newBtn.innerText = "Processing...";
                        
                        // Force update of Note and Date before redirecting
                        await updateCartAttributes(note, date);
                        
                        // Redirect
                        window.location.href = cart.checkoutUrl;
                    };
                }
            }

            // Render Items
            if (cartContainer) {
                if (cart.lines.edges.length === 0) {
                    cartContainer.innerHTML = `
                        <div class="flex flex-col items-center justify-center h-full text-gray-400 space-y-4">
                            <i class="fas fa-shopping-basket text-3xl text-sb-gold opacity-50"></i>
                            <p>Your cart is empty.</p>
                        </div>
                    `;
                } else {
                    cartContainer.innerHTML = cart.lines.edges.map(edge => {
                        const item = edge.node;
                        return `
                            <div class="flex items-center gap-4 mb-6 border-b border-gray-100 pb-4">
                                <div class="w-16 h-20 flex-shrink-0 bg-gray-50 border border-gray-100">
                                    <img src="${item.merchandise.image?.url || ''}" class="w-full h-full object-cover loaded" style="opacity: 1;">
                                </div>
                                <div class="flex-1">
                                    <h4 class="font-serif text-lg text-sb-black leading-tight mb-1">${item.merchandise.product.title}</h4>
                                    <p class="text-xs text-gray-500 mb-2">£${item.merchandise.price.amount}</p>
                                    <div class="flex items-center gap-4">
                                        <div class="flex items-center border border-gray-200">
                                            <button onclick="updateLineItem('${item.id}', ${item.quantity - 1})" class="px-2 py-1 text-gray-500 hover:text-sb-black">-</button>
                                            <span class="px-2 text-xs font-bold">${item.quantity}</span>
                                            <button onclick="updateLineItem('${item.id}', ${item.quantity + 1})" class="px-2 py-1 text-gray-500 hover:text-sb-black">+</button>
                                        </div>
                                        <button onclick="removeLineItem('${item.id}')" class="text-xs text-gray-400 hover:text-red-500 underline">Remove</button>
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('');
                }
            }
        }

        // Global function refs for inline HTML onclicks
        window.updateLineItem = updateLineItem;
        window.removeLineItem = removeLineItem;

        // DOM Elements & Event Listeners - Wrapped in DOMContentLoaded for safety
        document.addEventListener('DOMContentLoaded', () => {
            
            // Side Cart Open/Close Logic
            const sideCart = document.getElementById('side-cart');
            const sideCartOverlay = document.getElementById('side-cart-overlay');
            const closeCartBtn = document.getElementById('close-cart-btn');
            const cartIconBtn = document.getElementById('cart-icon-btn');
            const cartNote = document.getElementById('cart-note');
            const deliveryDate = document.getElementById('delivery-date');
            
            // Delivery/Collection Toggle
            const deliveryTab = document.getElementById('delivery-tab');
            const collectionTab = document.getElementById('collection-tab');
            const shippingInfo = document.getElementById('shipping-info');
            const collectionInfo = document.getElementById('collection-info');

            if(deliveryTab && collectionTab) {
                deliveryTab.addEventListener('click', () => {
                    deliveryTab.classList.add('bg-sb-black', 'text-white');
                    deliveryTab.classList.remove('bg-white', 'text-gray-500');
                    collectionTab.classList.remove('bg-sb-black', 'text-white');
                    collectionTab.classList.add('bg-white', 'text-gray-500');
                    shippingInfo.classList.remove('hidden');
                    collectionInfo.classList.add('hidden');
                });
                collectionTab.addEventListener('click', () => {
                    collectionTab.classList.add('bg-sb-black', 'text-white');
                    collectionTab.classList.remove('bg-white', 'text-gray-500');
                    deliveryTab.classList.remove('bg-sb-black', 'text-white');
                    deliveryTab.classList.add('bg-white', 'text-gray-500');
                    shippingInfo.classList.add('hidden');
                    collectionInfo.classList.remove('hidden');
                });
            }

            // Date Picker Init
            if (deliveryDate) {
                const today = new Date().toISOString().split('T')[0];
                deliveryDate.setAttribute('min', today);
                deliveryDate.addEventListener('change', handleCartInputUpdate);
            }

            if (cartNote) cartNote.addEventListener('input', handleCartInputUpdate);
            
            window.openCart = function() {
                if (sideCartOverlay && sideCart) {
                    sideCartOverlay.classList.remove('hidden');
                    setTimeout(() => {
                        sideCartOverlay.classList.remove('opacity-0');
                        sideCart.classList.remove('translate-x-full');
                    }, 10);
                }
            };

            window.closeCart = function() {
                if (sideCart && sideCartOverlay) {
                    sideCart.classList.add('translate-x-full');
                    sideCartOverlay.classList.add('opacity-0');
                    setTimeout(() => {
                        sideCartOverlay.classList.add('hidden');
                    }, 300);
                }
            };

            if (cartIconBtn) cartIconBtn.addEventListener('click', window.openCart);
            if (closeCartBtn) closeCartBtn.addEventListener('click', window.closeCart);
            if (sideCartOverlay) sideCartOverlay.addEventListener('click', window.closeCart);
            
            // Event Listeners for Add Buttons
            document.querySelectorAll('.shopify-add-btn').forEach(btn => {
                btn.addEventListener('click', async (e) => {
                    const id = btn.getAttribute('data-shopify-id');
                    const originalText = btn.innerText;
                    btn.innerText = "Adding...";
                    btn.classList.add('bg-sb-gold', 'text-sb-black', 'border-sb-gold');
                    btn.classList.remove('bg-sb-black', 'text-sb-cream', 'border-sb-black');
                    
                    if (id) {
                        await addToCart(id);
                        btn.innerText = "Added";
                    }
                    setTimeout(() => {
                        btn.innerText = originalText;
                        btn.classList.remove('bg-sb-gold', 'text-sb-black', 'border-sb-gold');
                        btn.classList.add('bg-sb-black', 'text-sb-cream', 'border-sb-black');
                    }, 2000);
                });
            });

            // Mobile Menu Logic
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const closeMenuBtn = document.getElementById('close-menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            const menuLinks = mobileMenu ? mobileMenu.querySelectorAll('a') : [];

            function toggleMenu() {
                if (!mobileMenu) return;
                const isClosed = mobileMenu.classList.contains('-translate-x-full');
                if (isClosed) {
                    mobileMenu.classList.remove('-translate-x-full');
                    document.body.style.overflow = 'hidden'; 
                } else {
                    mobileMenu.classList.add('-translate-x-full');
                    document.body.style.overflow = 'auto'; 
                }
            }

            if (mobileMenuBtn) mobileMenuBtn.addEventListener('click', toggleMenu);
            if (closeMenuBtn) closeMenuBtn.addEventListener('click', toggleMenu);
            menuLinks.forEach(link => link.addEventListener('click', toggleMenu));

            // Scroll Animation Observer
            const observerOptions = { root: null, rootMargin: '100px', threshold: 0.1 };
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) entry.target.classList.add('active');
                });
            }, observerOptions);
            document.querySelectorAll('.reveal').forEach((el) => observer.observe(el));

            // IMAGE FADE IN LOGIC
            function handleImageLoad(img) { img.classList.add('loaded'); }
            document.querySelectorAll('img').forEach(img => {
                if (img.complete) handleImageLoad(img);
                else img.addEventListener('load', () => handleImageLoad(img));
            });

            // Cookie Banner Logic
            window.acceptCookies = function() {
                const banner = document.getElementById('cookie-banner');
                if (banner) {
                    banner.classList.remove('translate-y-0');
                    banner.classList.add('translate-y-full');
                    localStorage.setItem('cookiesAccepted', 'true');
                }
            }

            if (!localStorage.getItem('cookiesAccepted')) {
                setTimeout(() => {
                    const banner = document.getElementById('cookie-banner');
                    if (banner) {
                        banner.classList.remove('translate-y-full');
                        banner.classList.add('translate-y-0');
                    }
                }, 2000); 
            }

            // Init Cart
            initCart();
            
            // NEW: SYNC WITH SHOPIFY LIVE DATA
            syncProductsWithShopify();
        });

        // -------------------------------------------------------------
        // LIVE PRODUCT SYNC
        // -------------------------------------------------------------
        
        function slugify(text) {
            return text.toString().toLowerCase()
                .replace(/\s+/g, '-')           // Replace spaces with -
                .replace(/[^\w\-]+/g, '')       // Remove all non-word chars
                .replace(/\-\-+/g, '-')         // Replace multiple - with single -
                .replace(/^-+/, '')             // Trim - from start
                .replace(/-+$/, '');            // Trim - from end
        }

        async function syncProductsWithShopify() {
            console.log("Syncing products...");
            const cards = document.querySelectorAll('.group[data-title]');
            
            // Process all cards in parallel
            const promises = Array.from(cards).map(async (card) => {
                const title = card.getAttribute('data-title');
                if (!title) return;
                
                const handle = slugify(title);
                
                const query = `
                    query getProduct($handle: String!) {
                        product(handle: $handle) {
                            id
                            title
                            description
                            featuredImage { url }
                            variants(first: 1) {
                                edges {
                                    node {
                                        id
                                        price { amount }
                                    }
                                }
                            }
                        }
                    }
                `;

                try {
                    const response = await shopifyFetch(query, { handle });
                    const product = response.data?.product;

                    if (product) {
                        // 1. Swap Image
                        if (product.featuredImage?.url) {
                            const img = card.querySelector('img');
                            if (img) {
                                img.style.opacity = '0'; // Fade out
                                setTimeout(() => {
                                    img.src = product.featuredImage.url;
                                    img.style.opacity = '1'; // Fade in
                                }, 300);
                            }
                            // Update data attribute for Quick View
                            card.setAttribute('data-image', product.featuredImage.url);
                        }
                        
                        // 2. Update Price & Variant ID
                        const variant = product.variants.edges[0]?.node;
                        if (variant) {
                            const priceFormatted = `£${parseFloat(variant.price.amount).toFixed(2)}`;
                            
                            // Find price element (it varies slightly in structure)
                            const priceEls = card.querySelectorAll('p');
                            priceEls.forEach(el => {
                                if (el.innerText.includes('£')) el.innerText = priceFormatted;
                            });

                            // Update Quick View Data
                            card.setAttribute('data-price', priceFormatted);
                            card.setAttribute('data-description', product.description || card.getAttribute('data-description'));
                            card.setAttribute('data-variant-id', variant.id); // Store real ID

                            // Update Add Button
                            const btn = card.querySelector('.shopify-add-btn');
                            if (btn) {
                                btn.setAttribute('data-variant-id', variant.id);
                                btn.innerText = "Add to Cart"; // Reset text
                            }
                        }
                    }
                } catch (e) {
                    // Fail silently and keep placeholder
                    console.log(`Could not sync ${title}:`, e);
                }
            });
            
            await Promise.all(promises);
            console.log("Sync complete.");
        }

        // Updated Add to Cart Listener Logic
        document.querySelectorAll('.shopify-add-btn').forEach(btn => {
            // Remove old listener by cloning (if not already done in updateCartUI)
            // But since we are initing fresh, we can just attach a smart listener
            btn.addEventListener('click', async (e) => {
                const variantId = btn.getAttribute('data-variant-id');
                const productId = btn.getAttribute('data-shopify-id');
                const originalText = btn.innerText;
                
                btn.innerText = "Adding...";
                btn.classList.add('bg-sb-gold', 'text-sb-black', 'border-sb-gold');
                btn.classList.remove('bg-sb-black', 'text-sb-cream', 'border-sb-black');
                
                let success = false;

                if (variantId) {
                    // Fast path: We already found the live variant ID
                    success = await addToCart(variantId, true);
                } else if (productId) {
                    // Slow path: Look up by legacy ID (likely won't work for new items without sync)
                    success = await addToCart(productId, false);
                }

                if (success) {
                    btn.innerText = "Added";
                } else {
                    btn.innerText = "Unavailable";
                }
                
                setTimeout(() => {
                    btn.innerText = originalText;
                    btn.classList.remove('bg-sb-gold', 'text-sb-black', 'border-sb-gold');
                    btn.classList.add('bg-sb-black', 'text-sb-cream', 'border-sb-black');
                }, 2000);
            });
        });

        // Updated Quick View Logic to use synced data
        function openQuickView(element) {
            const container = element.closest('.group');
            if (!container) return;

            const title = container.getAttribute('data-title');
            const price = container.getAttribute('data-price');
            const desc = container.getAttribute('data-description');
            const imgSrc = container.getAttribute('data-image');
            
            // Prefer the synced variant ID
            const variantId = container.getAttribute('data-variant-id'); 
            const productId = container.getAttribute('data-id');

            document.getElementById('qv-title').innerText = title;
            document.getElementById('qv-price').innerText = price;
            // Handle potentially empty description from sync
            const finalDesc = (desc && desc !== "undefined") ? desc : "A stunning arrangement from our collection.";
            document.getElementById('qv-description').innerText = finalDesc;
            
            document.getElementById('qv-image').src = imgSrc;
            
            const qvBtn = document.getElementById('qv-add-btn');
            
            if (variantId) {
                qvBtn.setAttribute('data-variant-id', variantId);
                qvBtn.removeAttribute('data-shopify-id');
            } else {
                qvBtn.setAttribute('data-shopify-id', productId);
            }

            document.getElementById('quick-view-modal').classList.remove('hidden');
        }

        // Updated AddToCart Function signature
        async function addToCart(idOrVariantId, isVariantId = false) {
            try {
                let variantId = idOrVariantId;
                
                if (!isVariantId) {
                    // Legacy lookup for manual IDs
                    const globalProductId = btoa(`gid://shopify/Product/${idOrVariantId}`);
                    const productQuery = `
                        query($id: ID!) {
                          product(id: $id) {
                            variants(first: 1) {
                              nodes { id }
                            }
                          }
                        }
                    `;
                    let productResult = await shopifyFetch(productQuery, { id: globalProductId });
                    
                    if (!productResult.data || !productResult.data.product) {
                         // Try raw ID fallback
                         const rawGid = `gid://shopify/Product/${idOrVariantId}`;
                         productResult = await shopifyFetch(productQuery, { id: rawGid });
                         if (!productResult.data || !productResult.data.product) {
                            console.warn("Product not found.");
                            return false; 
                         }
                    }
                    variantId = productResult.data.product.variants.nodes[0].id;
                }
                
                // Add to cart using Variant ID
                let cart = await initCart();
                if (!cart) cart = await createCart();
                
                const addLineQuery = `
                    mutation($cartId: ID!, $lines: [CartLineInput!]!) {
                      cartLinesAdd(cartId: $cartId, lines: $lines) {
                        cart {
                          id
                          totalQuantity
                          checkoutUrl
                          cost { subtotalAmount { amount currencyCode } }
                          lines(first: 10) {
                            edges {
                                node {
                                    id
                                    quantity
                                    merchandise {
                                        ... on ProductVariant {
                                            id
                                            title
                                            price { amount currencyCode }
                                            image { url }
                                            product { title }
                                        }
                                    }
                                }
                            }
                        }
                        }
                      }
                    }
                `;
                
                const addResult = await shopifyFetch(addLineQuery, {
                    cartId: cart.id,
                    lines: [{ merchandiseId: variantId, quantity: 1 }]
                });
                
                if (addResult.data && addResult.data.cartLinesAdd && addResult.data.cartLinesAdd.cart) {
                    updateCartUI(addResult.data.cartLinesAdd.cart);
                    if (window.openCart) window.openCart();
                    return true;
                }
                return false;

            } catch (e) {
                console.error("Error adding to cart:", e);
                return false;
            }
        }
    </script>
</body>
</html>
