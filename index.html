<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="description" content="SB Floristry is a premier mother and daughter florist team serving Essex and London.">
    <title>SB Floristry | Essex & London's Premier Mother-Daughter Florists</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Playfair+Display:ital,wght@0,300;0,400;0,500;1,400&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: { 'sb-black': '#0a0a0a', 'sb-gold': '#D4AF37', 'sb-cream': '#F9F8F6', 'sb-dark': '#1A1A1A' },
                    fontFamily: { serif: ['"Playfair Display"', 'serif'], sans: ['"Lato"', 'sans-serif'] },
                    letterSpacing: { 'luxury': '0.25em', 'super-wide': '0.35em' },
                    animation: { 'fade-in-up': 'fadeInUp 1.2s ease-out forwards', 'fade-in': 'fadeIn 1s ease-out forwards' },
                    keyframes: {
                        fadeInUp: { '0%': { opacity: '0', transform: 'translateY(20px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } },
                        fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } }
                    }
                }
            }
        }
    </script>

    <style>
        .hero-zoom { animation: slowZoom 25s infinite alternate; }
        @keyframes slowZoom { from { transform: scale(1); } to { transform: scale(1.05); } }

        .text-gold-metallic {
            background: linear-gradient(to right, #bf953f, #fcf6ba, #b38728, #fbf5b7, #aa771c);
            -webkit-background-clip: text; background-clip: text; color: transparent;
        }

        .bg-gold-shimmer {
            background: linear-gradient(90deg, #997b3a 0%, #b89546 25%, #D4AF37 50%, #b89546 75%, #997b3a 100%);
            background-size: 200% auto; animation: subtleShimmer 8s linear infinite;
        }
        @keyframes subtleShimmer { 0% { background-position: 0% 50%; } 100% { background-position: 100% 50%; } }

        .reveal { opacity: 0; transform: translateY(30px); transition: all 1s ease-out; }
        .reveal.active { opacity: 1; transform: translateY(0); }
        
        img { opacity: 0; transition: opacity 1.2s ease-out; }
        img.loaded { opacity: 1 !important; }
        
        .btn-luxury { position: relative; overflow: hidden; transition: color 0.4s; z-index: 1; }
        .btn-luxury::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-color: #D4AF37; z-index: -1; transform: scaleY(0); transform-origin: bottom;
            transition: transform 0.4s cubic-bezier(0.19, 1, 0.22, 1);
        }
        .btn-luxury:hover::before { transform: scaleY(1); }
        .btn-luxury:hover { color: #0a0a0a !important; border-color: #D4AF37; }

        .view-section { display: none; opacity: 0; transition: opacity 0.8s ease-in-out; }
        .view-section.active-view { display: block; opacity: 1; animation: fadeIn 1.2s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .nav-dropdown { opacity: 0; visibility: hidden; transform: translateY(10px); transition: all 0.3s ease-in-out; }
        .group:hover .nav-dropdown { opacity: 1; visibility: visible; transform: translateY(0); }
        .cart-overlay { background-color: rgba(0,0,0,0.3); backdrop-filter: blur(4px); }
        
        .mobile-accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
        .mobile-accordion-btn.active + .mobile-accordion-content { max-height: 500px; }
        .mobile-accordion-btn.active i { transform: rotate(180deg); }
        
        .loader {
            border: 2px solid #f3f3f3; border-top: 2px solid #D4AF37; border-radius: 50%;
            width: 24px; height: 24px; animation: spin 1s linear infinite; margin: 20px auto;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="font-sans text-sb-dark antialiased bg-sb-cream flex flex-col min-h-screen">

    <!-- Announcement Bar -->
    <div class="bg-gold-shimmer text-sb-black text-[10px] py-2.5 px-4 text-center tracking-[0.25em] uppercase font-bold border-b border-sb-cream/20">
        <p>Family Run • Free delivery over £60 within a 3 mile radius • UK Standard £4.99</p>
    </div>

    <!-- Header / Navigation -->
    <header class="sticky top-0 z-50 bg-sb-black/95 backdrop-blur-md transition-all duration-300 border-b border-white/5" id="main-header">
        <div class="container mx-auto px-6 lg:px-12">
            <div class="grid grid-cols-[1fr_auto_1fr] items-center h-20 md:h-24">
                
                <!-- Left Nav -->
                <div class="flex items-center justify-start lg:justify-end h-full">
                    <button id="mobile-menu-btn" class="lg:hidden text-xl text-sb-cream focus:outline-none hover:text-sb-gold transition-colors mr-auto p-2">
                        <i class="fas fa-bars"></i>
                    </button>
                    <nav class="hidden lg:flex space-x-8 xl:space-x-10 text-[11px] font-medium tracking-luxury text-gray-300 uppercase items-center">
                        <a href="#home" class="hover:text-sb-gold transition-colors duration-300">Home</a>
                        
                        <!-- DYNAMIC SHOP MENU -->
                        <div class="relative group h-full flex items-center">
                            <button class="hover:text-sb-gold transition-colors duration-300 focus:outline-none py-4 uppercase tracking-luxury flex items-center gap-1">
                                Shop Collections <i class="fas fa-chevron-down text-[8px] opacity-50 ml-1"></i>
                            </button>
                            <div id="nav-collections-container" class="nav-dropdown absolute top-full left-0 w-48 bg-sb-black border border-white/10 shadow-2xl pt-2 pb-2">
                                <span class="block px-6 py-3 text-[10px] text-gray-500">Loading...</span>
                            </div>
                        </div>
                    </nav>
                </div>

                <!-- Center Logo -->
                <div class="flex justify-center h-full items-center px-8">
                    <a href="#home" class="group block text-center">
                        <img src="images/logo.png" alt="SB Floristry" class="h-16 w-auto object-contain opacity-90 group-hover:opacity-100 transition-opacity">
                    </a>
                </div>

                <!-- Right Nav -->
                <div class="flex items-center justify-end lg:justify-between h-full w-full">
                    <nav class="hidden lg:flex space-x-8 xl:space-x-10 text-[11px] font-medium tracking-luxury text-gray-300 uppercase items-center">
                        <a href="#subscriptions" class="hover:text-sb-gold transition-colors duration-300">Subscriptions</a>
                        <!-- EVENTS MENU -->
                        <div class="relative group h-full flex items-center">
                            <button class="hover:text-sb-gold transition-colors duration-300 focus:outline-none py-4 uppercase tracking-luxury flex items-center gap-1">
                                Events <i class="fas fa-chevron-down text-[8px] opacity-50 ml-1"></i>
                            </button>
                            <div class="nav-dropdown absolute top-full right-0 w-56 bg-sb-black border border-white/10 shadow-2xl pt-2 pb-2">
                                <a href="#weddings" class="block px-6 py-3 hover:bg-white/5 hover:text-sb-gold text-[10px] tracking-luxury transition-colors">Weddings</a>
                                <a href="#funerals" class="block px-6 py-3 hover:bg-white/5 hover:text-sb-gold text-[10px] tracking-luxury transition-colors">Funerals</a>
                                <a href="#babyshowers" class="block px-6 py-3 hover:bg-white/5 hover:text-sb-gold text-[10px] tracking-luxury transition-colors">Baby Showers</a>
                                <a href="#genderreveal" class="block px-6 py-3 hover:bg-white/5 hover:text-sb-gold text-[10px] tracking-luxury transition-colors">Gender Reveal</a>
                                <a href="#workevents" class="block px-6 py-3 hover:bg-white/5 hover:text-sb-gold text-[10px] tracking-luxury transition-colors">Corporate</a>
                            </div>
                        </div>
                        <a href="#contact" class="hover:text-sb-gold transition-colors duration-300">Contact</a>
                    </nav>

                    <div class="flex items-center space-x-6 text-sb-cream/80">
                        <button id="cart-icon-btn" class="relative hover:text-sb-gold transition-colors group p-1">
                            <i class="fas fa-shopping-bag text-sm"></i>
                            <span id="cart-count" class="absolute -top-2 -right-2 text-sb-gold font-serif text-[10px] w-4 h-4 flex items-center justify-center opacity-0 transition-opacity duration-300">0</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Mobile Menu -->
    <div id="mobile-menu" class="fixed inset-0 bg-sb-black z-[100] transform -translate-x-full transition-transform duration-500 ease-in-out lg:hidden flex flex-col pt-20 px-8 overflow-y-auto">
        <button id="close-menu-btn" class="absolute top-6 right-6 text-2xl text-sb-cream hover:text-sb-gold transition-colors p-2">
            <i class="fas fa-times"></i>
        </button>
        <nav class="flex flex-col space-y-4 text-lg font-serif text-sb-cream text-center mt-6 font-light">
            <a href="#home" class="border-b border-white/5 pb-3 hover:text-sb-gold transition-colors block">Home</a>
            <div>
                <button class="mobile-accordion-btn w-full flex justify-between items-center text-sb-gold text-sm tracking-widest uppercase py-3 border-b border-white/5 focus:outline-none">
                    Shop Collections <i class="fas fa-chevron-down text-xs transition-transform duration-300"></i>
                </button>
                <div id="mobile-collections-container" class="mobile-accordion-content bg-white/5">
                    <span class="block py-3 text-sm text-gray-500">Loading...</span>
                </div>
            </div>
            <a href="#subscriptions" class="border-b border-white/5 pb-3 hover:text-sb-gold transition-colors block">Subscriptions</a>
            <div>
                <button class="mobile-accordion-btn w-full flex justify-between items-center text-sb-gold text-sm tracking-widest uppercase py-3 border-b border-white/5 focus:outline-none">
                    Events <i class="fas fa-chevron-down text-xs transition-transform duration-300"></i>
                </button>
                <div class="mobile-accordion-content bg-white/5">
                    <a href="#weddings" class="block py-3 text-base text-gray-300 hover:text-white">Weddings</a>
                    <a href="#funerals" class="block py-3 text-base text-gray-300 hover:text-white">Funerals</a>
                    <a href="#babyshowers" class="block py-3 text-base text-gray-300 hover:text-white">Baby Showers</a>
                    <a href="#genderreveal" class="block py-3 text-base text-gray-300 hover:text-white">Gender Reveal</a>
                    <a href="#workevents" class="block py-3 text-base text-gray-300 hover:text-white">Corporate</a>
                </div>
            </div>
             <a href="#contact" class="border-b border-white/5 pb-3 hover:text-sb-gold transition-colors block">Contact</a>
        </nav>
    </div>

    <!-- SIDE CART -->
    <div id="side-cart-overlay" class="fixed inset-0 cart-overlay z-[150] hidden opacity-0 transition-opacity duration-300"></div>
    <div id="side-cart" class="fixed top-0 right-0 h-full w-full max-w-[400px] bg-white z-[160] transform translate-x-full transition-transform duration-500 shadow-2xl flex flex-col">
        <div class="shrink-0 p-6 border-b border-gray-100 flex justify-between items-center bg-sb-black text-sb-cream">
            <h2 class="font-serif text-2xl tracking-wide font-light">Your Selection</h2>
            <button id="close-cart-btn" class="text-sb-gold hover:text-white transition-colors text-2xl"><i class="fas fa-times"></i></button>
        </div>
        <div class="shrink-0 px-6 py-4 bg-gray-50 border-b border-gray-100">
             <div id="shipping-info">
                 <p id="shipping-message" class="text-xs font-bold text-center text-sb-black mb-2">Spend <span class="text-sb-gold">£60.00</span> more for Free Delivery</p>
                 <div class="w-full bg-gray-200 h-1.5 rounded-full overflow-hidden"><div id="shipping-bar" class="bg-sb-gold h-full rounded-full transition-all duration-500" style="width: 0%"></div></div>
            </div>
        </div>
        <div class="flex-1 overflow-y-auto cart-scroll bg-white">
            <div id="cart-items-container" class="p-6 pb-2">
                <p class="text-sm tracking-luxury uppercase text-gray-400 text-center mt-10">Your cart is empty</p>
            </div>
            <div class="px-6 py-6 bg-sb-cream border-t border-gray-100">
                <div class="mb-6">
                    <label for="cart-note" class="block text-xs font-bold tracking-luxury uppercase text-gray-400 mb-2">Gift Message</label>
                    <textarea id="cart-note" rows="3" class="w-full bg-white border border-gray-200 p-3 text-base text-sb-black placeholder-gray-300 focus:border-sb-gold outline-none resize-none" placeholder="Card message..."></textarea>
                </div>
                <div class="mb-4">
                    <label for="delivery-date" class="block text-xs font-bold tracking-luxury uppercase text-gray-400 mb-2">Delivery Date</label>
                    <input type="date" id="delivery-date" class="w-full bg-white border border-gray-200 p-3 text-base text-sb-black focus:border-sb-gold outline-none">
                    <p id="date-error" class="text-xs text-red-500 mt-1 hidden"></p>
                </div>
            </div>
        </div>
        <div class="shrink-0 p-6 border-t border-gray-100 bg-white">
            <div class="flex justify-between items-end mb-6">
                <span class="text-xs font-bold tracking-luxury uppercase text-gray-400">Total</span>
                <span id="cart-subtotal" class="font-serif text-2xl text-sb-black">£0.00</span>
            </div>
            <button id="checkout-btn" onclick="proceedToCheckout()" class="w-full btn-luxury bg-sb-black text-sb-cream py-4 uppercase tracking-luxury text-xs font-bold border border-sb-black">Proceed to Checkout</button>
        </div>
    </div>

    <!-- QUICK VIEW MODAL -->
    <div id="quick-view-modal" class="fixed inset-0 z-[200] hidden overflow-y-auto">
        <div class="flex min-h-screen items-center justify-center p-4">
            <div class="fixed inset-0 bg-black/80 backdrop-blur-sm transition-opacity" onclick="closeQuickView()"></div>
            <div class="relative w-full max-w-4xl bg-white shadow-2xl overflow-hidden animate-fade-in-up flex flex-col md:flex-row">
                <button onclick="closeQuickView()" class="absolute top-4 right-4 text-gray-400 hover:text-sb-black z-10 p-2"><i class="fas fa-times text-2xl"></i></button>
                <div class="w-full md:w-1/2 h-64 md:h-auto bg-gray-100 relative"><img id="qv-image" src="" alt="" class="w-full h-full object-cover"></div>
                <div class="w-full md:w-1/2 p-8 md:p-12 flex flex-col justify-center bg-sb-cream">
                    <h3 id="qv-title" class="font-serif text-4xl md:text-5xl text-sb-black mb-2 font-normal"></h3>
                    <p id="qv-price" class="text-2xl text-sb-gold font-bold mb-6"></p>
                    <div class="w-12 h-px bg-gray-300 mb-6"></div>
                    <p id="qv-description" class="text-gray-600 font-light text-lg leading-relaxed mb-8"></p>
                    <button id="qv-add-btn" class="w-full btn-luxury bg-sb-black text-white py-4 uppercase tracking-luxury text-xs font-bold" onclick="addToCart(this, this.getAttribute('data-shopify-id'))">Add to Cart</button>
                </div>
            </div>
        </div>
    </div>

    <!-- MAIN CONTENT -->
    <main id="app-content" class="flex-grow min-h-screen">
        
        <!-- 1. VIEW: HOME -->
        <div id="view-home" class="view-section active-view">
            <section class="relative h-[90vh] overflow-hidden">
                <div class="absolute inset-0">
                    <img src="images/hero.jpg" alt="Luxury Bouquet" class="w-full h-full object-cover hero-zoom opacity-90" style="object-position: center 60%;">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-black/30"></div>
                </div>
                <div class="relative z-10 container mx-auto px-6 h-full flex flex-col justify-center items-center text-center text-sb-cream pt-20">
                    <h2 class="text-xs md:text-sm tracking-[0.3em] uppercase mb-8 font-medium text-sb-gold animate-fade-in">Hand-Tied in Essex • Delivered to London</h2>
                    <h1 class="font-serif text-6xl md:text-8xl lg:text-9xl mb-10 leading-none animate-fade-in-up font-normal">
                        Artistry in <br/><span class="italic font-light text-gold-metallic">Every Bloom</span>
                    </h1>
                    <a href="#collection-seasonal" class="animate-fade-in btn-luxury border border-sb-cream/30 text-sb-cream px-10 py-3 uppercase tracking-luxury text-xs font-bold hover:border-sb-gold">
                        Shop The Collection
                    </a>
                </div>
            </section>
            
            <section class="py-24 bg-sb-black text-sb-cream relative border-t border-white/5">
                <div class="container mx-auto px-6 text-center max-w-2xl">
                    <span class="text-gold-metallic text-2xl mb-6 block reveal"><i class="fas fa-leaf"></i></span>
                    <h2 class="font-serif text-4xl md:text-5xl text-sb-cream mb-8 reveal font-light">A Family Affair</h2>
                    <p class="text-gray-400 leading-relaxed text-xl font-light mb-12 reveal">
                        Welcome to SB Floristry. We are a mother and daughter team bringing bespoke, luxury floral design to weddings, events, and homes across Essex and London. Every arrangement is hand-selected and styled with the care only family can provide.
                    </p>
                    <div class="flex flex-col md:flex-row justify-center gap-12 text-xs font-bold tracking-luxury text-sb-cream uppercase reveal">
                        <div class="flex items-center justify-center"><i class="fas fa-truck mr-3 text-sb-gold"></i> Free Local Delivery</div>
                        <div class="flex items-center justify-center"><i class="fas fa-heart mr-3 text-sb-gold"></i> Family Owned</div>
                    </div>
                </div>
            </section>
            
            <section class="py-24 bg-sb-cream">
                <div class="container mx-auto px-6">
                    <div class="text-center mb-16 reveal">
                        <h3 class="font-serif text-5xl text-sb-black mb-4 font-light">Explore Our Collections</h3>
                        <div class="w-16 h-px bg-sb-gold mx-auto mt-6"></div>
                    </div>
                    <!-- Collections Grid (RESTORED) -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                        <a href="#collection-seasonal" class="group relative block h-[500px] overflow-hidden cursor-pointer reveal">
                            <img src="images/prod-winter.jpg" alt="Seasonal Collection" class="w-full h-full object-cover transition-transform duration-[1.5s] group-hover:scale-105 loaded" style="opacity:1;">
                            <div class="absolute inset-0 bg-black/20 group-hover:bg-black/30 transition-colors duration-500"></div>
                            <div class="absolute inset-0 flex flex-col items-center justify-center text-center p-4">
                                <h4 class="font-serif text-4xl text-sb-cream mb-2 translate-y-4 group-hover:translate-y-0 transition-transform duration-500 font-light">Seasonal</h4>
                                <span class="text-sb-cream text-xs tracking-luxury uppercase border-b border-transparent group-hover:border-sb-cream pb-1 opacity-0 group-hover:opacity-100 transition-all duration-500 delay-100">View Collection</span>
                            </div>
                        </a>
                        <a href="#collection-luxury" class="group relative block h-[500px] overflow-hidden cursor-pointer reveal delay-75">
                            <img src="images/prod-ivory.jpg" alt="Luxury Collection" class="w-full h-full object-cover transition-transform duration-[1.5s] group-hover:scale-105 loaded" style="opacity:1;">
                            <div class="absolute inset-0 bg-black/20 group-hover:bg-black/30 transition-colors duration-500"></div>
                            <div class="absolute inset-0 flex flex-col items-center justify-center text-center p-4">
                                <h4 class="font-serif text-4xl text-sb-cream mb-2 translate-y-4 group-hover:translate-y-0 transition-transform duration-500 font-light">Luxury</h4>
                                <span class="text-sb-cream text-xs tracking-luxury uppercase border-b border-transparent group-hover:border-sb-cream pb-1 opacity-0 group-hover:opacity-100 transition-all duration-500 delay-100">View Collection</span>
                            </div>
                        </a>
                        <a href="#collection-gothic" class="group relative block h-[500px] overflow-hidden cursor-pointer reveal delay-100">
                            <img src="images/prod-velvet-darkness.jpg" alt="Gothic Collection" class="w-full h-full object-cover transition-transform duration-[1.5s] group-hover:scale-105 loaded" style="opacity:1;">
                            <div class="absolute inset-0 bg-black/40 group-hover:bg-black/50 transition-colors duration-500"></div>
                            <div class="absolute inset-0 flex flex-col items-center justify-center text-center p-4">
                                <h4 class="font-serif text-4xl text-sb-cream mb-2 translate-y-4 group-hover:translate-y-0 transition-transform duration-500 font-light">Gothic</h4>
                                <span class="text-sb-cream text-xs tracking-luxury uppercase border-b border-transparent group-hover:border-sb-cream pb-1 opacity-0 group-hover:opacity-100 transition-all duration-500 delay-100">View Collection</span>
                            </div>
                        </a>
                        <a href="#collection-fairytale" class="group relative block h-[500px] overflow-hidden cursor-pointer reveal delay-125">
                            <img src="images/prod-bibbidi.jpg" alt="Fairy Tale Collection" class="w-full h-full object-cover transition-transform duration-[1.5s] group-hover:scale-105 loaded" style="opacity:1;">
                            <div class="absolute inset-0 bg-black/20 group-hover:bg-black/30 transition-colors duration-500"></div>
                            <div class="absolute inset-0 flex flex-col items-center justify-center text-center p-4">
                                <h4 class="font-serif text-4xl text-sb-cream mb-2 translate-y-4 group-hover:translate-y-0 transition-transform duration-500 font-light">Fairy Tale</h4>
                                <span class="text-sb-cream text-xs tracking-luxury uppercase border-b border-transparent group-hover:border-sb-cream pb-1 opacity-0 group-hover:opacity-100 transition-all duration-500 delay-100">View Collection</span>
                            </div>
                        </a>
                    </div>
                </div>
            </section>

            <!-- SUBSCRIPTION PROMO (RESTORED) -->
            <section class="py-24 bg-white">
                <div class="container mx-auto px-6">
                    <div class="flex flex-col lg:flex-row items-center gap-12 lg:gap-20">
                        <div class="w-full lg:w-1/2 h-[600px] reveal relative group overflow-hidden">
                             <img src="images/prod-subscription.jpg" alt="Subscriptions" class="w-full h-full object-cover transition-transform duration-[1.5s] group-hover:scale-105 loaded" style="opacity:1">
                             <div class="absolute inset-0 bg-black/10 group-hover:bg-black/0 transition-colors duration-500"></div>
                        </div>
                        <div class="w-full lg:w-1/2 text-center lg:text-left reveal delay-100">
                            <span class="text-sb-gold text-xs tracking-super-wide uppercase font-bold mb-4 block">Effortless Beauty</span>
                            <h2 class="font-serif text-4xl md:text-6xl text-sb-black mb-6 font-light">The Flower Subscription</h2>
                            <div class="w-16 h-px bg-sb-gold mx-auto lg:mx-0 mb-8"></div>
                            <p class="text-gray-600 font-light leading-relaxed mb-8 text-lg">
                                Enjoy the luxury of fresh, seasonal stems delivered directly to your door. Choose from weekly, bi-weekly, or monthly plans designed to bring life and fragrance to your home.
                            </p>
                            <div class="flex flex-col sm:flex-row gap-4 justify-center lg:justify-start">
                                <a href="#subscriptions" class="btn-luxury border border-sb-black text-sb-black px-12 py-4 uppercase tracking-luxury text-xs font-bold inline-block hover:bg-sb-black hover:text-white transition-all">
                                    View Plans
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- 2. VIEW: DYNAMIC COLLECTION -->
        <div id="view-dynamic-collection" class="view-section">
            <section class="pt-40 pb-20 bg-sb-cream text-center" id="dynamic-hero">
                <span class="text-sb-gold text-xs tracking-super-wide uppercase font-bold mb-4 block">The Collection</span>
                <h1 class="font-serif text-6xl md:text-8xl mb-6 font-light text-sb-black" id="dynamic-title">Loading...</h1>
                <p class="text-xl font-light italic text-gray-500 max-w-2xl mx-auto" id="dynamic-desc"></p>
            </section>
            <section class="pb-24 bg-sb-cream" id="dynamic-bg">
                 <div class="container mx-auto px-6">
                    <div id="dynamic-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-12">
                        <div class="col-span-full text-center py-12">
                             <div class="loader"></div>
                             <p class="text-gray-400 text-sm tracking-luxury uppercase">Fetching Blooms...</p>
                        </div>
                    </div>
                 </div>
            </section>
        </div>

        <!-- 3. VIEW: STATIC EVENTS (Full Content Restored) -->
        <div id="view-weddings" class="view-section">
            <section class="relative h-[60vh] overflow-hidden">
                <div class="absolute inset-0">
                    <img src="images/weddings-bg.jpg" alt="Weddings Banner" class="w-full h-full object-cover">
                    <div class="absolute inset-0 bg-black/50"></div>
                </div>
                <div class="relative z-10 container mx-auto px-6 h-full flex flex-col justify-center items-center text-center text-sb-cream">
                    <h1 class="font-serif text-6xl md:text-8xl mb-6 font-light">Weddings</h1>
                </div>
            </section>
            <section class="py-24 bg-sb-cream">
                <div class="container mx-auto px-6 max-w-4xl text-center">
                    <h2 class="font-serif text-4xl text-sb-black mb-8 font-light italic">Your Love Story, In Bloom</h2>
                    <p class="text-xl text-gray-600 font-light leading-relaxed mb-12">
                        From charming Essex countryside weddings to glamorous London ballroom celebrations, we design with heart and precision. We believe your wedding flowers should be as unique as your relationship, setting the tone for a day you will never forget.
                    </p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-12 mt-16 mb-16 text-left">
                        <div class="text-center">
                            <div class="h-64 overflow-hidden mb-6">
                                <img src="images/wedding-bridal.jpg" alt="Bridal Party" class="w-full h-full object-cover hover:scale-105 transition-transform duration-700 loaded" style="opacity:1">
                            </div>
                            <h3 class="font-serif text-2xl text-sb-black mb-2">Bridal Party</h3>
                            <p class="text-sm text-gray-500 leading-relaxed">Exquisite bouquets and buttonholes tailored to your palette.</p>
                        </div>
                        <div class="text-center">
                            <div class="h-64 overflow-hidden mb-6">
                                <img src="images/wedding-ceremony.jpg" alt="Ceremony" class="w-full h-full object-cover hover:scale-105 transition-transform duration-700 loaded" style="opacity:1">
                            </div>
                            <h3 class="font-serif text-2xl text-sb-black mb-2">Ceremony</h3>
                            <p class="text-sm text-gray-500 leading-relaxed">Aisle markers, archways, and pew ends that create a magical setting.</p>
                        </div>
                        <div class="text-center">
                            <div class="h-64 overflow-hidden mb-6">
                                <img src="images/wedding-reception.jpg" alt="Reception" class="w-full h-full object-cover hover:scale-105 transition-transform duration-700 loaded" style="opacity:1">
                            </div>
                            <h3 class="font-serif text-2xl text-sb-black mb-2">Reception</h3>
                            <p class="text-sm text-gray-500 leading-relaxed">Breathtaking centrepieces and installations for the perfect celebration.</p>
                        </div>
                    </div>

                    <a href="#contact" class="btn-luxury border border-sb-black text-sb-black px-10 py-3 uppercase tracking-luxury text-xs font-bold inline-block">Book Consultation</a>
                </div>
            </section>
        </div>
        
        <div id="view-funerals" class="view-section">
            <section class="pt-40 pb-20 bg-sb-cream text-center">
                <span class="text-sb-gold text-xs tracking-super-wide uppercase font-bold mb-4 block">Sympathy & Remembrance</span>
                <h1 class="font-serif text-5xl md:text-7xl mb-6 font-light text-sb-black">Farewell with Grace</h1>
            </section>
            <section class="pb-24 bg-sb-cream">
                <div class="container mx-auto px-6 max-w-4xl">
                     <div class="text-center mb-16">
                        <p class="text-xl text-gray-600 font-light leading-relaxed">
                            We understand the importance of saying goodbye beautifully. Sympathy arrangements created with care using seasonal blooms. Let us help you express your condolences when words are not enough.
                        </p>
                     </div>
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-16">
                         <div class="bg-white p-8 shadow-sm hover:shadow-md transition-shadow">
                             <h3 class="font-serif text-2xl text-sb-black mb-4">Casket Sprays</h3>
                             <p class="text-gray-500 font-light mb-4">Elegant, double-ended sprays that sit perfectly atop the casket. Available in various sizes and color palettes.</p>
                             <span class="text-sb-gold text-xs tracking-widest uppercase font-bold">From £150</span>
                         </div>
                         <div class="bg-white p-8 shadow-sm hover:shadow-md transition-shadow">
                             <h3 class="font-serif text-2xl text-sb-black mb-4">Wreaths & Hearts</h3>
                             <p class="text-gray-500 font-light mb-4">Traditional circular wreaths or heart-shaped tributes symbolizing eternal love. Hand-made with fresh moss bases.</p>
                             <span class="text-sb-gold text-xs tracking-widest uppercase font-bold">From £65</span>
                         </div>
                         <div class="bg-white p-8 shadow-sm hover:shadow-md transition-shadow">
                             <h3 class="font-serif text-2xl text-sb-black mb-4">Posies & Baskets</h3>
                             <p class="text-gray-500 font-light mb-4">Smaller, thoughtful arrangements perfect for family members to contribute or for grave-side placement.</p>
                             <span class="text-sb-gold text-xs tracking-widest uppercase font-bold">From £45</span>
                         </div>
                         <div class="bg-white p-8 shadow-sm hover:shadow-md transition-shadow">
                             <h3 class="font-serif text-2xl text-sb-black mb-4">Bespoke Tributes</h3>
                             <p class="text-gray-500 font-light mb-4">Letters (MUM, DAD), religious symbols, or custom shapes that reflect the personality and hobbies of the departed.</p>
                             <span class="text-sb-gold text-xs tracking-widest uppercase font-bold">POA</span>
                         </div>
                     </div>
                    <div class="text-center">
                         <a href="#contact" class="btn-luxury border border-sb-black text-sb-black px-10 py-3 uppercase tracking-luxury text-xs font-bold inline-block">Contact Us</a>
                    </div>
                </div>
            </section>
        </div>
        
        <div id="view-babyshowers" class="view-section">
            <section class="pt-40 pb-20 bg-sb-cream text-center">
                <h1 class="font-serif text-6xl md:text-8xl mb-6 font-light text-sb-black">Baby Showers</h1>
            </section>
            <section class="pb-24 bg-sb-cream">
                <div class="container mx-auto px-6 max-w-5xl">
                    <div class="text-center mb-16">
                        <p class="text-xl text-gray-600 font-light leading-relaxed max-w-3xl mx-auto">
                            From flower arches to delicate table centres, we create the perfect backdrop for celebrating the upcoming arrival. Whether you desire soft pastels, neutral creams, or vibrant themes, we bring the vision to life.
                        </p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
                        <div class="h-[500px] overflow-hidden">
                             <img src="images/babyshower-arch.jpg" alt="Baby Shower Arch" class="w-full h-full object-cover loaded" style="opacity:1">
                        </div>
                        <div class="space-y-8">
                            <div>
                                <h3 class="font-serif text-3xl text-sb-black mb-3">"Oh Baby" Backdrops</h3>
                                <p class="text-gray-500 font-light">The ultimate photo opportunity. We combine lush foliage, fresh blooms, and optional neon signage or balloons to create a focal point for your event.</p>
                            </div>
                            <div>
                                <h3 class="font-serif text-3xl text-sb-black mb-3">Table Scapes</h3>
                                <p class="text-gray-500 font-light">Bud vases running down long tables or grand centrepieces for round tables. We style the flowers to complement your favors and cake.</p>
                            </div>
                            <div>
                                <h3 class="font-serif text-3xl text-sb-black mb-3">Flower Crowns</h3>
                                <p class="text-gray-500 font-light">Make the mum-to-be feel extra special with a bespoke fresh flower crown, or host a crown-making workshop as an activity!</p>
                            </div>
                            <a href="#contact" class="btn-luxury border border-sb-black text-sb-black px-10 py-3 uppercase tracking-luxury text-xs font-bold inline-block mt-4">Enquire Now</a>
                        </div>
                    </div>
                </div>
            </section>
        </div>
        
        <div id="view-genderreveal" class="view-section">
             <section class="pt-40 pb-20 bg-sb-cream text-center">
                <h1 class="font-serif text-6xl md:text-8xl mb-6 font-light text-sb-black">Gender Reveal</h1>
                <p class="text-xl text-gray-600 font-light max-w-2xl mx-auto mb-8">Pink or Blue? Build the anticipation with our stunning reveal boxes and floral arrangements.</p>
                <a href="#contact" class="btn-luxury border border-sb-black text-sb-black px-10 py-3 uppercase tracking-luxury text-xs font-bold inline-block mt-8">Enquire Now</a>
            </section>
        </div>
        
        <div id="view-workevents" class="view-section">
             <section class="pt-40 pb-20 bg-sb-black text-center text-sb-cream">
                <span class="text-sb-gold text-xs tracking-super-wide uppercase font-bold mb-4 block">Corporate Services</span>
                <h1 class="font-serif text-5xl md:text-7xl mb-6 font-light">Hotels, Spas & Events</h1>
            </section>
            <section class="pb-24 bg-sb-black text-sb-cream">
                <div class="container mx-auto px-6 max-w-5xl">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-16">
                        <div>
                             <h3 class="font-serif text-3xl text-sb-gold mb-6">Hotels & Lobbies</h3>
                             <p class="text-gray-400 font-light leading-relaxed mb-6">
                                 First impressions matter. We provide weekly contract flowers for hotel lobbies, receptions, and restaurants across London and Essex. Our designs are architectural, long-lasting, and tailored to your brand's interior aesthetic.
                             </p>
                             <ul class="text-sm tracking-widest uppercase space-y-3 text-gray-500">
                                 <li><i class="fas fa-check text-sb-gold mr-2"></i> Weekly Installation & Maintenance</li>
                                 <li><i class="fas fa-check text-sb-gold mr-2"></i> Vase Hire Included</li>
                                 <li><i class="fas fa-check text-sb-gold mr-2"></i> Dedicated Account Manager</li>
                             </ul>
                        </div>
                        <div>
                             <h3 class="font-serif text-3xl text-sb-gold mb-6">Luxury Spas</h3>
                             <p class="text-gray-400 font-light leading-relaxed mb-6">
                                 Enhance the serenity of your spa environment with biophilic design. We create calming arrangements using eucalyptus, orchids, and tropical foliage that thrive in humid environments and promote relaxation.
                             </p>
                             <ul class="text-sm tracking-widest uppercase space-y-3 text-gray-500">
                                 <li><i class="fas fa-check text-sb-gold mr-2"></i> Long-lasting tropicals</li>
                                 <li><i class="fas fa-check text-sb-gold mr-2"></i> Aromatherapy-complementary blooms</li>
                             </ul>
                        </div>
                    </div>
                    
                    <div class="mt-20 border-t border-white/10 pt-16 text-center">
                        <h3 class="font-serif text-3xl text-white mb-6">Client Gifting & Events</h3>
                        <p class="text-gray-400 font-light max-w-2xl mx-auto mb-10">From product launches to employee appreciation bouquets, we handle all your corporate floral needs.</p>
                        <a href="#contact" class="btn-luxury border border-sb-cream text-sb-cream px-10 py-3 uppercase tracking-luxury text-xs font-bold inline-block">Request a Proposal</a>
                    </div>
                </div>
            </section>
        </div>

        <!-- 4. VIEW: SUBSCRIPTIONS -->
        <div id="view-subscriptions" class="view-section">
            <section class="relative h-[60vh] overflow-hidden">
                <div class="absolute inset-0">
                    <img src="images/prod-subscription.jpg" alt="Flower Subscription" class="w-full h-full object-cover">
                    <div class="absolute inset-0 bg-black/40"></div>
                </div>
                <div class="relative z-10 container mx-auto px-6 h-full flex flex-col justify-center items-center text-center text-sb-cream">
                    <span class="text-sb-gold text-xs tracking-super-wide uppercase font-bold mb-4 animate-fade-in">Join the Club</span>
                    <h1 class="font-serif text-6xl md:text-8xl mb-6 font-light animate-fade-in-up">Flower Subscriptions</h1>
                    <p class="text-lg font-light tracking-wide max-w-xl mx-auto animate-fade-in">Fresh blooms delivered to your door, on your schedule.</p>
                </div>
            </section>
            
            <section class="py-24 bg-sb-cream">
                <div class="container mx-auto px-6">
                    <div class="text-center mb-16">
                        <span class="text-sb-gold text-xs tracking-super-wide uppercase font-bold mb-4 block">Effortless Beauty</span>
                        <h2 class="font-serif text-4xl text-sb-black mb-6">How It Works</h2>
                        <p class="text-gray-600 font-light leading-relaxed max-w-2xl mx-auto text-lg mb-12">
                            Select your preferred plan and let us handle the rest. We curate the finest seasonal stems, condition them, and deliver them ready to arrange. Perfect for keeping your home vibrant or as a thoughtful, recurring gift.
                        </p>
                        <div class="w-16 h-px bg-sb-gold mx-auto mt-6"></div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-6xl mx-auto">
                        <!-- Plan 1 -->
                        <div class="bg-white p-8 border border-gray-100 flex flex-col items-center text-center hover:shadow-xl transition-shadow duration-300 group" data-title="The Seasonal Subscription" data-price="£45.00" data-image="images/prod-subscription.jpg">
                            <h3 class="font-serif text-2xl text-sb-black mb-2">The Seasonal</h3>
                            <p class="text-xs tracking-widest text-gray-400 uppercase mb-6">Monthly Joy</p>
                            <div class="text-4xl font-serif text-sb-gold mb-6">£45<span class="text-sm text-gray-400 font-sans">/mo</span></div>
                            <ul class="text-sm text-gray-500 space-y-4 mb-8 flex-grow">
                                <li>Seasonal hand-tied bouquet</li>
                                <li>Delivered once a month</li>
                                <li>Cancel anytime</li>
                            </ul>
                            <button onclick="addToCart(this, 'sub_seasonal')" class="w-full btn-luxury bg-sb-black text-sb-cream py-3 uppercase tracking-luxury text-xs font-bold">Subscribe</button>
                        </div>
                        
                        <!-- Plan 2 -->
                        <div class="bg-sb-black text-sb-cream p-8 border border-sb-gold transform scale-105 shadow-2xl flex flex-col items-center text-center relative group" data-title="The Luxury Subscription" data-price="£85.00" data-image="images/prod-subscription.jpg">
                            <span class="absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-sb-gold text-sb-black text-[10px] uppercase font-bold px-3 py-1 tracking-widest">Most Popular</span>
                            <h3 class="font-serif text-2xl mb-2">The Luxury</h3>
                            <p class="text-xs tracking-widest text-gray-400 uppercase mb-6">Bi-Weekly Indulgence</p>
                            <div class="text-4xl font-serif text-sb-gold mb-6">£85<span class="text-sm text-gray-400 font-sans">/mo</span></div>
                            <ul class="text-sm text-gray-300 space-y-4 mb-8 flex-grow">
                                <li>Premium stems & larger arrangement</li>
                                <li>Delivered every 2 weeks</li>
                                <li>Luxury Vase included</li>
                            </ul>
                            <button onclick="addToCart(this, 'sub_luxury')" class="w-full btn-luxury bg-sb-gold text-sb-black border-sb-gold py-3 uppercase tracking-luxury text-xs font-bold">Subscribe</button>
                        </div>
                        
                        <!-- Plan 3 -->
                        <div class="bg-white p-8 border border-gray-100 flex flex-col items-center text-center hover:shadow-xl transition-shadow duration-300 group" data-title="The Weekly Subscription" data-price="£150.00" data-image="images/prod-subscription.jpg">
                            <h3 class="font-serif text-2xl text-sb-black mb-2">The Weekly</h3>
                            <p class="text-xs tracking-widest text-gray-400 uppercase mb-6">Ultimate Freshness</p>
                            <div class="text-4xl font-serif text-sb-gold mb-6">£150<span class="text-sm text-gray-400 font-sans">/mo</span></div>
                            <ul class="text-sm text-gray-500 space-y-4 mb-8 flex-grow">
                                <li>Fresh flowers every week</li>
                                <li>Rotates between styles</li>
                                <li>Perfect for home styling</li>
                            </ul>
                            <button onclick="addToCart(this, 'sub_weekly')" class="w-full btn-luxury bg-sb-black text-sb-cream py-3 uppercase tracking-luxury text-xs font-bold">Subscribe</button>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- 5. VIEW: CONTACT -->
        <div id="view-contact" class="view-section">
            <section class="pt-40 pb-20 bg-sb-black text-center text-sb-cream">
                <span class="text-sb-gold text-xs tracking-super-wide uppercase font-bold mb-4 block">Get in Touch</span>
                <h1 class="font-serif text-5xl md:text-7xl mb-12 font-light">Contact Us</h1>
                
                <div class="flex flex-col md:flex-row justify-center gap-12 mb-16 text-lg font-light tracking-wide">
                    <div>
                        <i class="fas fa-phone text-sb-gold mb-4 text-2xl block"></i>
                        <p class="text-xs uppercase tracking-luxury text-gray-500 mb-2">Telephone</p>
                        <a href="tel:01708956609" class="hover:text-sb-gold transition-colors">01708 956609</a>
                    </div>
                    <div>
                        <i class="fas fa-envelope text-sb-gold mb-4 text-2xl block"></i>
                        <p class="text-xs uppercase tracking-luxury text-gray-500 mb-2">Email</p>
                        <a href="mailto:info@sbfloristry.co.uk" class="hover:text-sb-gold transition-colors">info@sbfloristry.co.uk</a>
                    </div>
                </div>
            </section>

            <section class="pb-24 bg-sb-black text-sb-cream border-t border-white/5">
                <div class="container mx-auto px-6 max-w-4xl">
                    <form id="contact-form" class="space-y-8 reveal">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div class="space-y-1">
                                <label class="text-xs font-bold tracking-luxury uppercase text-sb-gold">Name</label>
                                <input type="text" name="name" required class="w-full bg-transparent border-b border-gray-700 focus:border-sb-gold outline-none py-2 transition-colors text-sb-cream placeholder-gray-600 text-base">
                            </div>
                            <div class="space-y-1">
                                <label class="text-xs font-bold tracking-luxury uppercase text-sb-gold">Email</label>
                                <input type="email" name="email" required class="w-full bg-transparent border-b border-gray-700 focus:border-sb-gold outline-none py-2 transition-colors text-sb-cream placeholder-gray-600 text-base">
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div class="space-y-1">
                                <label class="text-xs font-bold tracking-luxury uppercase text-sb-gold">Event Date (Optional)</label>
                                <input type="date" name="date" class="w-full bg-transparent border-b border-gray-700 focus:border-sb-gold outline-none py-2 transition-colors text-sb-cream text-gray-400 text-base">
                            </div>
                            <div class="space-y-1">
                                <label class="text-xs font-bold tracking-luxury uppercase text-sb-gold">Interest</label>
                                <select name="interest" class="w-full bg-transparent border-b border-gray-700 focus:border-sb-gold outline-none py-2 transition-colors text-sb-cream text-base">
                                    <option value="Weddings" class="bg-sb-black">Weddings</option>
                                    <option value="Events" class="bg-sb-black">Events</option>
                                    <option value="Subscription" class="bg-sb-black">Subscription</option>
                                    <option value="Hotels" class="bg-sb-black">Hotels & Spas</option>
                                    <option value="Bespoke Order" class="bg-sb-black">Bespoke Order</option>
                                </select>
                            </div>
                        </div>
                        <div class="space-y-1">
                            <label class="text-xs font-bold tracking-luxury uppercase text-sb-gold">Message</label>
                            <textarea name="message" rows="4" required class="w-full bg-transparent border-b border-gray-700 focus:border-sb-gold outline-none py-2 transition-colors text-sb-cream placeholder-gray-600 text-base"></textarea>
                        </div>
                        <div class="text-center pt-8">
                            <button type="submit" class="btn-luxury border border-sb-cream text-sb-cream px-16 py-4 uppercase tracking-luxury text-xs font-bold inline-block">
                                Send Inquiry
                            </button>
                        </div>
                    </form>
                </div>
            </section>
        </div>

    </main>

    <!-- GLOBAL CONTACT FOOTER (Visible on Home Page) -->
    <section class="py-24 bg-sb-black text-sb-cream" id="contact-section">
        <div class="container mx-auto px-6 max-w-4xl">
            <div class="text-center mb-12 reveal">
                <h3 class="font-serif text-5xl md:text-6xl text-sb-cream mb-4 font-light">Start Your Floral Journey</h3>
                <p class="font-light text-gray-400 text-lg">Tell us about your event or custom request.</p>
            </div>
            <!-- Duplicate Form for Home Page Footer -->
            <form id="home-contact-form" class="space-y-8 reveal">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="space-y-1">
                        <label class="text-xs font-bold tracking-luxury uppercase text-sb-gold">Name</label>
                        <input type="text" name="name" required class="w-full bg-transparent border-b border-gray-700 focus:border-sb-gold outline-none py-2 transition-colors text-sb-cream placeholder-gray-600 text-base">
                    </div>
                    <div class="space-y-1">
                        <label class="text-xs font-bold tracking-luxury uppercase text-sb-gold">Email</label>
                        <input type="email" name="email" required class="w-full bg-transparent border-b border-gray-700 focus:border-sb-gold outline-none py-2 transition-colors text-sb-cream placeholder-gray-600 text-base">
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="space-y-1">
                        <label class="text-xs font-bold tracking-luxury uppercase text-sb-gold">Event Date (Optional)</label>
                        <input type="date" name="date" class="w-full bg-transparent border-b border-gray-700 focus:border-sb-gold outline-none py-2 transition-colors text-sb-cream text-gray-400 text-base">
                    </div>
                    <div class="space-y-1">
                        <label class="text-xs font-bold tracking-luxury uppercase text-sb-gold">Interest</label>
                        <select name="interest" class="w-full bg-transparent border-b border-gray-700 focus:border-sb-gold outline-none py-2 transition-colors text-sb-cream text-base">
                            <option value="Weddings" class="bg-sb-black">Weddings</option>
                            <option value="Events" class="bg-sb-black">Events</option>
                            <option value="Subscription" class="bg-sb-black">Subscription</option>
                            <option value="Hotels" class="bg-sb-black">Hotels & Spas</option>
                            <option value="Bespoke Order" class="bg-sb-black">Bespoke Order</option>
                        </select>
                    </div>
                </div>
                <div class="space-y-1">
                    <label class="text-xs font-bold tracking-luxury uppercase text-sb-gold">Message</label>
                    <textarea name="message" rows="4" required class="w-full bg-transparent border-b border-gray-700 focus:border-sb-gold outline-none py-2 transition-colors text-sb-cream placeholder-gray-600 text-base"></textarea>
                </div>
                <div class="text-center pt-8">
                    <button type="submit" class="btn-luxury border border-sb-cream text-sb-cream px-16 py-4 uppercase tracking-luxury text-xs font-bold inline-block">
                        Send Inquiry
                    </button>
                </div>
            </form>
        </div>
    </section>

    <footer class="bg-sb-black text-gray-500 pt-16 pb-8 border-t border-white/5 text-center">
        <div class="container mx-auto px-6">
            <h3 class="font-serif text-3xl text-sb-cream mb-4 font-light tracking-widest">SB FLORISTRY</h3>
            <p class="text-xs tracking-widest uppercase opacity-50">&copy; 2026 SB Floristry. Made in Essex.</p>
        </div>
    </footer>

    <script>
        const CONFIG = {
            shopify: {
                domain: 'sb-floristry.myshopify.com',
                accessToken: '35527e42586bf1abcce2dda69206eec9'
            },
            emailJS: { publicKey: "Oaw-LoMGaOOjSh2GO", serviceID: "service_jnmsvja", templateID: "template_9u9b45v" },
            collectionTags: [
                { title: 'Seasonal', tag: 'seasonal' },
                { title: 'Luxury', tag: 'luxury' },
                { title: 'Gothic', tag: 'gothic' },
                { title: 'Fairy Tale', tag: 'fairytale' }
            ]
        };

        // NAV & ROUTING
        function initDynamicNav() {
            const deskContainer = document.getElementById('nav-collections-container');
            const mobContainer = document.getElementById('mobile-collections-container');
            let deskHTML = '';
            let mobHTML = '';

            CONFIG.collectionTags.forEach(c => {
                const link = `#collection-${c.tag}`; 
                deskHTML += `<a href="${link}" class="block px-6 py-3 hover:bg-white/5 hover:text-sb-gold text-[10px] tracking-luxury transition-colors uppercase">${c.title}</a>`;
                mobHTML += `<a href="${link}" class="block py-3 text-base text-gray-300 hover:text-white">${c.title}</a>`;
            });

            deskContainer.innerHTML = deskHTML;
            mobContainer.innerHTML = mobHTML;
        }

        function handleRoute() {
            let hash = window.location.hash.substring(1) || 'home';
            if (hash === 'contact') {
                switchView('view-contact');
                // Hide home footer contact form when on actual contact page to avoid redundancy
                document.getElementById('contact-section').style.display = 'none';
                return;
            } else {
                document.getElementById('contact-section').style.display = 'block';
            }

            if (hash.startsWith('collection-')) {
                const tag = hash.replace('collection-', '');
                renderDynamicCollection(tag);
                switchView('view-dynamic-collection');
            } else {
                const viewMap = {
                    'home': 'view-home',
                    'weddings': 'view-weddings',
                    'funerals': 'view-funerals',
                    'babyshowers': 'view-babyshowers',
                    'genderreveal': 'view-genderreveal',
                    'workevents': 'view-workevents',
                    'subscriptions': 'view-subscriptions'
                };
                const target = viewMap[hash] || 'view-home';
                switchView(target);
            }
        }

        function switchView(id) {
            document.querySelectorAll('.view-section').forEach(section => {
                if (section.id === id) {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                    setTimeout(() => section.classList.add('active-view'), 50);
                } else {
                    section.classList.remove('active-view');
                }
            });
        }

        // FETCH & RENDER
        async function renderDynamicCollection(tag) {
            const titleEl = document.getElementById('dynamic-title');
            const gridEl = document.getElementById('dynamic-grid');
            const descEl = document.getElementById('dynamic-desc');
            const heroEl = document.getElementById('dynamic-hero');
            const bgEl = document.getElementById('dynamic-bg');

            const configItem = CONFIG.collectionTags.find(c => c.tag === tag);
            const displayTitle = configItem ? configItem.title : tag.toUpperCase();

            titleEl.innerText = displayTitle;
            descEl.innerText = "Curating blooms...";
            gridEl.innerHTML = `<div class="col-span-full text-center py-12"><div class="loader"></div></div>`;
            
            if (tag.includes('gothic') || tag.includes('dark')) {
                heroEl.className = "pt-40 pb-20 bg-sb-black text-center";
                bgEl.className = "pb-24 bg-sb-black";
                titleEl.className = "font-serif text-6xl md:text-8xl mb-6 font-light text-sb-cream";
            } else {
                heroEl.className = "pt-40 pb-20 bg-sb-cream text-center";
                bgEl.className = "pb-24 bg-sb-cream";
                titleEl.className = "font-serif text-6xl md:text-8xl mb-6 font-light text-sb-black";
            }

            const query = `{
              products(first: 20, query: "tag:${tag}") {
                edges {
                  node {
                    id
                    title
                    handle
                    description
                    images(first: 1) {
                      edges {
                        node { url altText }
                      }
                    }
                    variants(first: 1) {
                      edges {
                        node { id price { amount currencyCode } }
                      }
                    }
                  }
                }
              }
            }`;

            try {
                const data = await shopifyFetch(query);
                const products = data?.data?.products?.edges || [];
                
                descEl.innerText = `The ${displayTitle} Collection`;

                if(products.length === 0) {
                    gridEl.innerHTML = `<p class="col-span-full text-center text-gray-500">No products found for tag: #${tag}</p>`;
                } else {
                    const isDark = tag.includes('gothic') || tag.includes('dark');
                    gridEl.innerHTML = products.map(edge => createProductCard(edge.node, isDark)).join('');
                    
                    setTimeout(() => {
                        gridEl.querySelectorAll('img').forEach(img => {
                            if (img.complete) img.classList.add('loaded');
                            else img.addEventListener('load', () => img.classList.add('loaded'));
                        });
                    }, 10);
                }
            } catch (err) {
                console.error(err);
                gridEl.innerHTML = `<p class="col-span-full text-center text-red-400">Error loading products.</p>`;
            }
        }

        async function shopifyFetch(query, variables = {}) {
            try {
                const response = await fetch(`https://${CONFIG.shopify.domain}/api/2024-01/graphql.json`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'X-Shopify-Storefront-Access-Token': CONFIG.shopify.accessToken },
                    body: JSON.stringify({ query, variables })
                });
                return await response.json();
            } catch (error) { console.warn(error); return null; }
        }

        function createProductCard(product, isDarkTheme) {
            const price = product.variants.edges[0]?.node?.price;
            const priceText = price ? `£${price.amount}` : '£0.00';
            const img = product.images.edges[0]?.node?.url || 'images/placeholder.jpg';
            const variantId = product.variants.edges[0]?.node?.id || product.id;
            
            const textClass = isDarkTheme ? "text-sb-cream" : "text-sb-black";
            const subText = isDarkTheme ? "text-sb-gold" : "text-gray-500";
            const btnBg = isDarkTheme ? "bg-sb-cream text-sb-black" : "bg-white/90 text-sb-black";
            const border = isDarkTheme ? "border border-white/10" : "";

            return `
             <div class="group relative reveal active" data-title="${product.title}" data-price="${priceText}" data-image="${img}" data-description="${product.description}" data-shopify-id="${variantId}">
                 <div class="relative overflow-hidden mb-4 aspect-[4/5] group-image-container ${border}">
                     <img src="${img}" alt="${product.title}" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105" onerror="this.style.opacity=1; this.src='images/placeholder.jpg'">
                     <button onclick="openQuickView(this)" class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white/90 text-sb-black w-10 h-10 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition duration-300 z-20 hover:bg-sb-gold"><i class="fas fa-eye"></i></button>
                     <button class="absolute bottom-0 left-0 w-full ${btnBg} py-4 translate-y-full group-hover:translate-y-0 transition-transform duration-300 font-bold tracking-luxury text-[10px] uppercase" onclick="addToCart(this, '${variantId}')">Add to Cart</button>
                 </div>
                 <h4 class="font-serif text-2xl ${textClass} mb-1 font-light">${product.title}</h4>
                 <p class="font-medium ${subText} text-base">${priceText}</p>
             </div>`;
        }

        // CART LOGIC
        window.cartItems = [];

        async function addToCart(btn, id) {
            let title, price, image;
            const parent = btn.closest('.group') || btn.closest('.bg-white') || btn.closest('.bg-sb-black');
            
            if (parent) {
                if (parent.dataset.title) {
                    title = parent.dataset.title;
                    price = parent.dataset.price;
                    image = parent.dataset.image;
                } else {
                    title = parent.querySelector('h3')?.innerText || 'Product';
                    const priceEl = parent.querySelector('.text-4xl');
                    price = priceEl ? priceEl.innerText.split('/')[0] : '£0.00';
                    image = 'images/prod-subscription.jpg'; 
                }
            }

            const originalText = btn.innerText;
            btn.innerText = "Adding...";
            btn.disabled = true;

            // TRACK CART ITEM FOR CHECKOUT
            window.cartItems.push({
                variantId: id,
                quantity: 1
            });

            await new Promise(r => setTimeout(r, 400));

            const cartContainer = document.getElementById('cart-items-container');
            const emptyMsg = cartContainer.querySelector('p.text-center');
            if(emptyMsg) emptyMsg.remove();

            const itemHTML = `
                <div class="flex gap-4 mb-4 animate-fade-in border-b border-gray-50 pb-4" data-variant-id="${id}">
                    <div class="w-16 h-16 bg-gray-100 shrink-0 overflow-hidden">
                        <img src="${image}" class="w-full h-full object-cover">
                    </div>
                    <div class="flex-1">
                        <h4 class="text-sm font-serif text-sb-black">${title}</h4>
                        <p class="text-xs text-gray-500 mb-1">Quantity: 1</p>
                        <p class="text-sm font-bold text-sb-gold">${price}</p>
                    </div>
                    <button onclick="removeFromCart(this, '${id}')" class="text-gray-300 hover:text-red-500 h-fit"><i class="fas fa-trash"></i></button>
                </div>
            `;
            cartContainer.insertAdjacentHTML('beforeend', itemHTML);

            updateCartTotal();
            btn.innerText = "Added";
            openCart();
            setTimeout(() => { btn.innerText = originalText; btn.disabled = false; }, 1500);
        }

        function removeFromCart(btn, id) {
            btn.closest('.flex').remove();
            const index = window.cartItems.findIndex(item => item.variantId === id);
            if(index > -1) window.cartItems.splice(index, 1);
            updateCartTotal();
        }

        function updateCartTotal() {
            const container = document.getElementById('cart-items-container');
            const items = container.querySelectorAll('.flex.gap-4');
            const badge = document.getElementById('cart-count');
            
            badge.innerText = items.length;
            badge.style.opacity = items.length > 0 ? 1 : 0;

            let total = 0;
            items.forEach(item => {
                const priceStr = item.querySelector('.text-sb-gold').innerText;
                const val = parseFloat(priceStr.replace(/[^0-9.]/g, ''));
                total += val;
            });
            
            document.getElementById('cart-subtotal').innerText = '£' + total.toFixed(2);
            
            if(items.length === 0) {
                container.innerHTML = '<p class="text-sm tracking-luxury uppercase text-gray-400 text-center mt-10">Your cart is empty</p>';
            }
            
            const progress = Math.min((total / 60) * 100, 100);
            const bar = document.getElementById('shipping-bar');
            if(bar) bar.style.width = `${progress}%`;
            
            const shipMsg = document.getElementById('shipping-message');
            if(shipMsg) {
                if(total >= 60) shipMsg.innerHTML = '<span class="text-sb-gold font-bold">Free Delivery Unlocked!</span>';
                else shipMsg.innerHTML = `Spend <span class="text-sb-gold">£${(60 - total).toFixed(2)}</span> more for Free Delivery`;
            }
        }

        async function proceedToCheckout() {
            if(window.cartItems.length === 0) {
                alert("Your cart is empty.");
                return;
            }

            const btn = document.getElementById('checkout-btn');
            const originalText = btn.innerText;
            btn.innerText = "Processing...";
            btn.disabled = true;

            const note = document.getElementById('cart-note').value;
            const deliveryDate = document.getElementById('delivery-date').value;

            if(!deliveryDate) {
                alert("Please select a delivery date.");
                btn.innerText = originalText;
                btn.disabled = false;
                return;
            }

            const lineItems = window.cartItems.map(item => ({
                variantId: item.variantId,
                quantity: item.quantity
            }));

            const input = {
                lineItems: lineItems,
                note: note,
                customAttributes: [
                    { key: "Delivery Date", value: deliveryDate }
                ]
            };

            const mutation = `
                mutation checkoutCreate($input: CheckoutCreateInput!) {
                    checkoutCreate(input: $input) {
                        checkout { webUrl }
                        checkoutUserErrors { code field message }
                    }
                }
            `;

            try {
                const data = await shopifyFetch(mutation, { input });
                const checkout = data.data.checkoutCreate.checkout;
                
                if(checkout && checkout.webUrl) {
                    window.location.href = checkout.webUrl;
                } else {
                    console.error(data.data.checkoutCreate.checkoutUserErrors);
                    alert("There was an issue creating your checkout. Please try again.");
                    btn.innerText = originalText;
                    btn.disabled = false;
                }
            } catch (err) {
                console.error(err);
                alert("Network error. Please try again.");
                btn.innerText = originalText;
                btn.disabled = false;
            }
        }

        function openQuickView(el) {
            const p = el.closest('.group');
            document.getElementById('qv-title').innerText = p.dataset.title;
            document.getElementById('qv-price').innerText = p.dataset.price;
            document.getElementById('qv-description').innerText = p.dataset.description;
            document.getElementById('qv-image').src = p.dataset.image;
            document.getElementById('qv-add-btn').setAttribute('data-shopify-id', p.dataset.shopifyId);
            document.getElementById('quick-view-modal').classList.remove('hidden');
        }
        function closeQuickView() { document.getElementById('quick-view-modal').classList.add('hidden'); }
        function openCart() { 
            document.getElementById('side-cart-overlay').classList.remove('hidden');
            setTimeout(() => { document.getElementById('side-cart-overlay').classList.remove('opacity-0'); document.getElementById('side-cart').classList.remove('translate-x-full'); }, 10);
        }
        function closeCart() {
            document.getElementById('side-cart').classList.add('translate-x-full');
            document.getElementById('side-cart-overlay').classList.add('opacity-0');
            setTimeout(() => document.getElementById('side-cart-overlay').classList.add('hidden'), 300);
        }

        function setupForms() {
            if (typeof emailjs !== 'undefined') emailjs.init(CONFIG.emailJS.publicKey);
            ['contact-form', 'home-contact-form'].forEach(id => {
                const f = document.getElementById(id);
                if(f) f.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const btn = this.querySelector('button[type="submit"]');
                    const ogText = btn.innerText;
                    btn.innerText = "Sending..."; btn.disabled = true;
                    emailjs.sendForm(CONFIG.emailJS.serviceID, CONFIG.emailJS.templateID, this)
                        .then(() => { alert('Message Sent!'); btn.innerText = ogText; btn.disabled = false; this.reset(); }, 
                              () => { alert('Error sending message.'); btn.innerText = ogText; btn.disabled = false; });
                });
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            initDynamicNav(); 
            window.addEventListener('hashchange', handleRoute);
            handleRoute();
            setupForms();

            document.getElementById('mobile-menu-btn')?.addEventListener('click', () => document.getElementById('mobile-menu').classList.toggle('-translate-x-full'));
            document.getElementById('close-menu-btn')?.addEventListener('click', () => document.getElementById('mobile-menu').classList.add('-translate-x-full'));
            document.getElementById('cart-icon-btn')?.addEventListener('click', openCart);
            document.getElementById('close-cart-btn')?.addEventListener('click', closeCart);
            document.getElementById('side-cart-overlay')?.addEventListener('click', closeCart);
            document.querySelectorAll('.mobile-accordion-btn').forEach(btn => btn.addEventListener('click', () => btn.classList.toggle('active')));
            
            // 48-HOUR NOTICE & NO SUNDAY LOGIC
            const dateInput = document.getElementById('delivery-date');
            if(dateInput) {
                const today = new Date();
                // 48 Hours = 2 days
                today.setDate(today.getDate() + 2);
                
                const yyyy = today.getFullYear();
                const mm = String(today.getMonth() + 1).padStart(2, '0');
                const dd = String(today.getDate()).padStart(2, '0');
                const minDateString = `${yyyy}-${mm}-${dd}`;
                
                dateInput.min = minDateString;
                
                dateInput.addEventListener('change', function() {
                    const selectedDate = new Date(this.value);
                    const day = selectedDate.getDay(); // 0 is Sunday
                    
                    if(this.value < minDateString) {
                        this.value = '';
                        const err = document.getElementById('date-error');
                        if(err) {
                            err.innerText = "Minimum 48 hours notice required.";
                            err.classList.remove('hidden');
                        }
                    } else if (day === 0) {
                        this.value = '';
                        const err = document.getElementById('date-error');
                        if(err) {
                            err.innerText = "We do not deliver on Sundays.";
                            err.classList.remove('hidden');
                        }
                    } else {
                        document.getElementById('date-error')?.classList.add('hidden');
                    }
                });
            }

            const obs = new IntersectionObserver((entries) => entries.forEach(e => e.isIntersecting && e.target.classList.add('active')), {threshold: 0.1});
            document.querySelectorAll('.reveal').forEach(el => obs.observe(el));
        });
    </script>
</body>
</html>
